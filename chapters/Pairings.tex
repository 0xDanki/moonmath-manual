\documentclass[11pt, lettersize, notitlepage, leqno, footskip=0.6cm]{article}

\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}	
%\usepackage{graphicx}
\usepackage{amscd}
%\usepackage{mathabx}
%\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
%\SetKwComment{Comment}{$\triangleright$\ }{}

%\usepackage[T1]{fontenc}% http://ctan.org/pkg/fontenc
%\usepackage[outline]{contour}% http://ctan.org/pkg/contour
%\usepackage{xcolor}% http://ctan.org/pkg/xcolor

\usepackage{authblk}

\usepackage{fancyvrb}

\usepackage{tikz-cd}

\usepackage[nodisplayskipstretch]{setspace}

% This the preamble, load any packages you're going to use here
%\usepackage{physics} % provides lots of nice features and commands often used in physics, it also loads some other packages (like AMSmath)
%\usepackage{siunitx} % typesets numbers with units very nicely
\usepackage{enumerate} % allows us to customize our lists
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{tikz}
%\usetikzlibrary{decorations.pathreplacing}
%\usepackage[colorinlistoftodos]{todonotes}
%\usepackage{pgfplots} 
%\pgfplotsset{width=10cm,compat=1.9} 
\usepackage{verbatim}

\usepackage[linewidth=1pt]{mdframed}

\usepackage{thmtools}
\usepackage[none]{hyphenat}

\usepackage{indentfirst}

\usepackage{braket}

\usepackage[shortlabels]{enumitem}

\usepackage{appendix}



\usepackage[bookmarks=true]{hyperref}
\usepackage{bookmark}

\DeclareFontFamily{U}{mathx}{\hyphenchar\font45}
\DeclareFontShape{U}{mathx}{m}{n}{
      <5> <6> <7> <8> <9> <10>
      <10.95> <12> <14.4> <17.28> <20.74> <24.88>
      mathx10
      }{}
\DeclareSymbolFont{mathx}{U}{mathx}{m}{n}
\DeclareFontSubstitution{U}{mathx}{m}{n}
\DeclareMathAccent{\widecheck}{0}{mathx}{"71}
\DeclareMathAccent{\wideparen}{0}{mathx}{"75}

\def\cs#1{\texttt{\char`\\#1}}



\addtolength{\textwidth}{100pt}
\addtolength{\evensidemargin}{-50pt}
\addtolength{\oddsidemargin}{-50pt}
\addtolength{\topmargin}{-60pt}
\addtolength{\textheight}{1.5in}
%\setlength{\parindent}{0in}
\setlength{\parskip}{1.5pt}


\setlength{\abovedisplayskip}{0cm}
\setlength{\belowdisplayskip}{0cm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Begin user defined commands


\newcommand{\bc}{\mathbb C}
\newcommand{\bF}{\mathbb F}
\newcommand{\bH}{\mathbb H}
\newcommand{\bn}{\mathbb N}
\newcommand{\bz}{\mathbb Z}
\newcommand{\bp}{\mathbb{P}}
\newcommand{\bq}{\mathbb Q}
\newcommand{\br}{\mathbb R}
\newcommand{\bS}{\mathbb S}

\newcommand{\bFp}{\mathbb{F}_p}
\newcommand{\bFP}{\ov{\mathbb{F}}_p}
\newcommand{\bFl}{\mathbb{F}_l}
\newcommand{\bFq}{\mathbb{F}_q}
\newcommand{\bFqk}{\mathbb{F}_{q^k}}
\newcommand{\bFQ}{\ov{\mathbb{F}}_q}
\newcommand{\bFpk}{\mathbb{F}_{p^k}}


\newcommand{\pl}{\prod\limits}
\newcommand{\slim}{\sum\limits}
\newcommand{\bcup}{\bigcup\limits}
\newcommand{\bcap}{\bigcap\limits}

\newcommand{\ttt}{\texttt}

\newcommand{\bT}{\mathbf T}
\newcommand{\bTl}{\mathbf T_{{\bq_l}}}
\newcommand{\bTlbar}{\mathbf T_{{\qbar_l}}}

\newcommand{\G}{\mathcal G}

\newcommand{\Gal}{\mathrm{Gal}}
\newcommand{\scl}{\mathcal L}

\newcommand{\W}{\mathcal W}
\newcommand{\WA}{\mathcal{W}_{A_v}}

\newcommand{\zbar}{\overline {\mathbb{Z}}}
\newcommand{\qbar}{\overline {\mathbb{Q}}}

\newcommand{\Fbar}{\overline {F}}
\newcommand{\Kbar}{\overline {K}}

\newcommand{\bark}{\overline {k}}

\newcommand{\bg}{\mathbb{G}}
\newcommand{\bG}{\mathbb{G}}

\newcommand{\st}{\mathrm{st}}

\newcommand{\uni}{\mathrm{uni}}

\newcommand{\lcm}{\mathrm{lcm}}

\newcommand{\negl}{\ttt{{negl}}}

\newcommand{\pr}{\protect}

\newcommand{\Acc}{\mbf{Acc}}

\newcommand{\sett}{\ttt{Set}}

\newcommand{\mult}{\mr{mult}}
\newcommand{\mul}{\mr{mult}}


\newcommand{\absq}{\mathrm{Gal}_{\bq}}
\newcommand{\absql}{\mathrm{Gal}_{\bq_l}}
\newcommand{\absqp}{\mathrm{Gal}_{\bq_p}}
\newcommand{\absqph}{\mathrm{Gal}_{\bq_{p^h}}}

\newcommand{\absf}{\mathrm{Gal}_F}
\newcommand{\absfv}{\mathrm{Gal}_{F_v}}
\newcommand{\abse}{\mathrm{Gal}_E}
\newcommand{\absk}{\mathrm{Gal}_K}
\newcommand{\absl}{\mathrm{Gal}_L}

\newcommand{\Div}{\mathrm{Div}}
\newcommand{\divv}{\mathrm{div}}




\newcommand{\Gm}{\mathbb{G}_m}

\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\rarrrow}{\rightarrow}
\newcommand{\lra}{\longrightarrow}
\newcommand{\llra}{\longleftrightarrow}
\newcommand{\xra}{\xrightarrow}
\newcommand{\hra}{\hookrightarrow}
\newcommand{\LRA}{\Longleftrightarrow}
\newcommand{\RA}{\Longrightarrow}
\newcommand{\harrow}{\hookrightarrow}
\newcommand{\lhra}{\hooklongrightarrow}

\newcommand{\imp}{\Longrightarrow}

\newcommand{\impop}{\overset{\;\;\;\;\mr{o.p.}\;\;\;\;}{\Longrightarrow}}

\newcommand{\eqlam}{\equiv_{\lam}}

\newcommand{\lameq}{\equiv_{\lam}}


\newcommand{\bs}{\backslash}
\newcommand{\ti}{\tilde}
\newcommand{\wti}{\widetilde}
\newcommand{\mf}{\mathfrak}
\newcommand{\mc}{\mathcal}
\newcommand{\mb}{\mathbb}
\newcommand{\mbf}{\mathbf} 
\newcommand{\mr}{\mathrm}
\newcommand{\mfp}{\mathfrak{p}}
\newcommand{\tmfp}{\ti{\mc{P}}}
\newcommand{\mfm}{\mathfrak{m}}
\newcommand{\mfn}{\mathfrak{n}}

\newcommand{\e}{\mathbf{e}}

\newcommand{\pro}{\protect\verb}


\newcommand{\mfl}{\mathfrak{l}}

\newcommand{\zetamn}{\zeta_{mn}}

\newcommand{\setm}{\setminus}
\newcommand{\sm}{\setminus}

\newcommand{\Br}{\mr{Br}}

\newcommand{\Jac}{\mr{Jac}}

\newcommand{\al}{\alpha}
\newcommand{\be}{\beta}
\newcommand{\ga}{\gamma}
\newcommand{\Ga}{\Gamma}
\newcommand{\Gam}{\Gamma}
\newcommand{\lam}{\lambda}
\newcommand{\lamb}{\lambda}
\newcommand{\Lam}{\Lambda}
\newcommand{\Lamb}{\Lambda}
\newcommand{\del}{\delta}
\newcommand{\Del}{\Delta}
\newcommand{\si}{\sigma}
\newcommand{\tsi}{\tilde{\sigma}}
\newcommand{\om}{\omega}
\newcommand{\Om}{\Omega}
\newcommand{\what}{\widehat}
\newcommand{\weck}{\widecheck}


\newcommand{\ov}{\overline}


\newcommand{\bzlam}{\bz_{(\lam)}}

\newcommand{\bzs}{\bz_{\mc{S}}}
\newcommand{\bzS}{\bz_{\mc{S}}}

\newcommand{\sub}{\subseteq}

\newcommand{\nsub}{\nsubseteq}

\newcommand{\dlog}{\mbf{dlog}}

\newcommand{\Prob}{\ttt{Pr}}

\newcommand{\bO}{\mbf{O}}

\newcommand{\mP}{\mc{P}}

\newcommand{\A}{\mc{A}}

\newcommand{\V}{\mc{V}}

\newcommand{\mcM}{\mc{M}}


\newcommand{\Com}{\ttt{Com}}

\newcommand{\vs}{\vspace{-0.15cm}}

\newcommand{\para}{\;\;\;\;\;\;}

\newcommand{\noin}{\noindent}

\newcommand{\op}{overwhelming probability}

\newcommand{\np}{negligible probability}

\newcommand{\non}{non-interactive proof}

\newcommand{\nons}{non-interactive proofs}

\newcommand{\sta}{\stackrel{?}{=}}

\newcommand{\Mod}[1]{\ (\mathrm{mod}\ #1)}

\newcommand{\LCM}{\mbf{lcm}}

\newcommand{\GCD}{\mbf{gcd}}

\newcommand{\intt}{\ttt{int}}

\newcommand{\un}{\ttt{uni}}

\newcommand{\new}{\ttt{new}}

\newcommand{\Ext}{\ttt{Ext}}

\newcommand{\E}{\mc{E}}

\newcommand{\End}{\mr{End}}

\newcommand{\mbr}{\mbf{r}}

\newcommand{\mule}{\mu_{\ell}}



%  End user defined commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% These establish different environments for stating Theorems, Lemmas, Remarks, etc.

\newtheorem{Thm}{Theorem}[section]
\newtheorem{Prop}[Thm]{Proposition}
\newtheorem{Lem}[Thm]{Lemma}
\newtheorem{Corr}[Thm]{Corollary}
\newtheorem{Algo}[Thm]{Algorithm}
\newtheorem{Example}[Thm]{Example}

\newtheorem{Prot}[Thm]{Protocol}

\newtheorem{Def}{Definition}[section]

\newtheorem{Fact}{Fact}[section]

\newtheorem{Ass}{Assumption}[section]

\newtheorem{Rem}[Thm]{Remark}

\declaretheorem{theorem} 
\declaretheoremstyle[%
  spaceabove=-2pt,%
  spacebelow=8pt,%
  headfont=\normalfont\itshape,%
  postheadspace=1em,%
  qed=\qedsymbol%
]{mystyle} 
\declaretheorem[name={Proof},style=mystyle,unnumbered,
]{prf}

\declaretheorem[name={Step},style=bold,unnumbered, %postheadspace=1em,%
qed=\qedsymbol%
]{prf1}

\numberwithin{equation}{section}


%\renewcommand{\labelenumi}{(\alphaph{enumi})}

% End environments 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Now we're ready to start
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\linespread{1.00}




\begin{document}


 
\title{Pairings}
\author{}
\date{}
 
\maketitle

\subsection{\fontsize{11}{11}\selectfont Bilinear Pairings}





\begin{Def} \normalfont For abelian groups $\mb{G}_1$, $\mb{G}_2$, $\mb{G}_T$, a \textit{pairing} $$\mathbf{e}:\mb{G}_1\times \mb{G}_2 \lra \mb{G}_T$$ is a map with the following properties.

\noindent 1. Bilinearity: $\mathbf{e}(x_1+x_2,y_1+y_2) = \mathbf{e}(x_1, y_2)\cdot\mathbf{e}(x_1, y_2)\cdot\mathbf{e}(x_2, y_1)\cdot\mathbf{e}(x_2, y_2)$\\ $\forall\; x_1,x_2\in \mb{G}_1,\; y_1,y_2\in \mb{G}_2$.

\noindent 2. Non-degeneracy: The image of $\mathbf{e}$ is non-trivial.

\noindent 3. Efficient computability.\end{Def}

In particular, for elements $x_1,y_1\in \mb{G}_1$, $x_2,y_2\in \mb{G}_2$, we have $ e(x_1,y_1) = e(x_2,y_1)\in \mb{G}_T$ if and only if there exists an integer $s\in [0,p-1]$ such that $y_1 = x_1^s$ and $y_2 = x_2^s$. This simple fact is deceptively powerful and lies at the heart of several zero-knowledge proof schemes. In all of the existing pairing based SNARKs and zero knowledge proof systems, the pairings are performed by the \textit{Verifier} rather than the Prover. Thus, it is fundamentally important for the pairings to be efficient. 

In pairing-based cryptography, we typically work in settings where the groups $\mb{G}_1$, $\mb{G}_2$, $\mb{G}_T$ are cyclic of order $p$ for some $256$-bit prime $p$ so as to have a $128$-bit security level. Such pairings $\mathbf{e}:\mb{G}_1\times \mb{G}_2 \lra \mb{G}_T$ are classified into three types:

\noindent - Type $\mr{I}$: $\mb{G}_1 = \mb{G}_2$.

\noindent - Type $\mr{II}$: $\mb{G}_1 \neq \mb{G}_2$ but there is an \textit{efficiently computable} isomorphism between $\mb{G}_1$ and $\mb{G}_2$.

\noindent - Type $\mr{III}$: There is no \textit{efficiently computable} isomorphism between $\mb{G}_1$ and $\mb{G}_2$.

At present, the only efficient pairings that we know of are those arising from (Jacobians of) hyperelliptic curves over finite fields. The most efficient of these are the ones arising from elliptic curves, i.e. hyperelliptic curves of genus one. The fact that elliptic curves - which were pivotal to cryptography even before pairings gained traction - are the best known source of pairings seems to be a happy coincidence.



\subsubsection{\fontsize{11}{11}\selectfont Cryptographic assumptions}



We state the computationally infeasible problems that the security of pairing-based SNARKs hinges on.

\begin{Def} {\normalfont \textbf{{$n$-strong Diffie Hellman assumption:}}} Let $\mb{G}$ be a cyclic group of prime order $p$ generated by an element $g$, and let $s \in \bFp^*$. Any probabilistic polynomial-time algorithm that is given the set $\{g^{s^i}: 1\leq i\leq n \}$ can find a pair $(a, g^{1/(s+a)})\in \bFp^*\times \mb{G}$ with at most negligible probability.\end{Def}

\begin{Def} {\normalfont \textbf{{Knowledge of exponent (KEA) assumption:}}}. Let $\mb{G}$ be a cyclic group of prime order $p$ generated by an element $g$, and let $s \in \bFp^*$. Suppose there exists a PPT algorithm $\mc{A}_1$ that given the set $\{g^{s^i}, g^{s^i\al}: 1\leq i\leq n \}$, outputs a pair $(c_1, c_2)\in \mb{G}\times\mb{G}$ such that $c_2 = c_1^{\al}$. Then there exists a PPT algorithm $\mc{A}_2$ that, with overwhelming probability, outputs a polynomial $f(X)\in \bFp[X]$ of degree $\leq n$ such that $c_1 = g^{f(s)}$, $c_2 = g^{\al f(s)}$.\end{Def}

The $n$-strong Diffie Hellman is a stronger assumption than the older and more battle-tested discrete logarithm assumption in elliptic curves. The KEA assumption is even younger and is unfalsifiable. This is one of the downsides to pairing-based SNARKs when compared to schemes such as Bulletproofs, DARK etc that do not rely on pairings.

\subsubsection{\fontsize{11}{11}\selectfont Membership proofs}


We now discuss a simple example of an application of pairings, namely set membership proofs. This could be though of as an application specific SNARK.

We describe the setup in this section. Let $\mb{G}_1, \mb{G}_2, \mb{G}_T$ be cyclic groups of order $p$ for some prime $p$ such that there exists a pairing ${\bf{e}}:\mb{G}_1\times \mb{G}_2\lra \mb{G}_T$ which is \textit{bilinear}, \textit{non-degenerate} and \textit{efficiently computable}. Fix generators $g_1, g_2$ of the cyclic groups $\mb{G}_1, \mb{G}_2$ respectively. Then ${\bf{e}}(g_1,g_2)$ is a generator of $\mb{G}_T$. Unlike in the case of accumulators based on groups of unknown order, the (common) order of the groups is public. Instead, the secret trapdoor is an integer $s$ in the range $[1, p-1]$ which will serve as the private key. Unfortunately, the generation of the private key requires a trusted setup. This can be partially mitigated by using a secure multi-party computation. A Verifier needs to assume that at least one of the parties involved in the MPC is honest enough not to collude with the other participants. 

For a data set $\mc{D} = \{d_1,\cdots, d_n\}$, we define the accumulated digest \vs $$\mr{Acc}(\mc{D}):= g_1^{\prod\limits_{d\in \mc{D}} (d+s)} \in \mb{G}_1.$$ For a subset $\mc{D}_0\sub \mc{D}$, the witness for $\mc{D}_0$ is defined by $$\mr{Wit}(\mc{D}_0) := g_1^{\prod\limits_{d\in \mc{D}\setminus \mc{D}_0} (d+s)}.$$ The Verifier then needs to check whether $$\mr{Wit}(\mc{D}_0)^{\prod\limits_{d_0\in \mc{D}_0} (d_0+s)} = \mr{Acc}(\mc{D}).$$ Because of the bilinearity of the pairing, it is equivalent and usually more efficient to verify the following equation: \vs $${\bf{e}}\Big(\mr{Wit}(\mc{D}_0)\;,\; g_2^{\prod\limits_{d_0\in \mc{D}_0} (d_0+s)}\Big) = {\bf{e}}(\mr{Acc}(\mc{D}), g_2).$$ Since none of the parties are aware of the value of $s$, it is necessary to broadcast the sets $\{g_1, g_1^s,\cdots , g_1^{s^n}\}$ and $\{g_2, g_2^s,\cdots , g_2^{s^n}\}$ to the Prover.

In the orignal bilinear accumulator, the Verifier needs access to the sets $\{g_1, g_1^s,\cdots , g_1^{s^n}\}$ and $\{g_2, g_2^s,\cdots , g_2^{s^n}\}$. But we can modify the scheme so that the Verifier only needs the four points $\{g_1,g_1^s, g_2, g_2^s \}$ to verify membership or non-membership.

The exponent $\prod\limits_{d\in \mc{D}} (d+s)$ can be interpreted as a degree $n$ polynomial in the variable $s$. The coefficients of the polynomial are computed with a run time of ${\bf{O}} (n\log(n))$ using the Fast Fourier transform. Furthermore, the set $\bFp[X]$ of polynomials with $\bFp$-coefficients is a principal ideal domain whose maximal ideals are those generated by the irreducible polynomials. For a data set $\mc{D}$, the polynomial $f(X) = \prod\limits_{d\in \mc{D}}(X+d)$ is monic of degree $n = |\mc{D}|$. Let $c_i$ denote the coefficient of $X^i$, i.e. $f(X) = \sum\limits_{i=0}^n c_iX^i$. The coefficients can be computed in run time ${\bf{O}}(n\log(n))$ using the Fast Fourier transform. The elements $$g_1^{f(s)} = \prod\limits_{i=0}^n (g_1^{s^i})^{c_i}\;\in\mb{G}_1\;\;,\;\;g_2^{f(s)} = \prod\limits_{i=0}^n (g_2^{s^i})^{c_i}\;\in\mb{G}_2 $$ can then be computed by any party that possesses the elements $\{g_1^{s^i}, g_2^{s^i} :\; 0\leq i \leq n  \}$. The collision-resistance of the bilinear accumulator hinges on the $n$-Strong Diffie Hellman assumption. 


\begin{Prot} \hypertarget{PoE}{ \textit{Proof of exponent for pairings} $(\tt{PoE})$}:\end{Prot} \vspace{-0.3cm}

\noindent \textbf{Parameters :} A pairing ${\bf{e}}: \mb{G}_1\times \mb{G}_2\lra \mb{G}_T$ of groups of prime order $p$; generators $g_1, g_2$ of $\mb{G}_1$, $\mb{G}_2$ respectively; a secret element $s\in \bFp^*$ such that the Prover possesses the elements $\{g_1^{s^i}, g_2^{s^i}:\; 0\leq i\leq n \}$ 

\noindent \textbf{Inputs:} $a,b\in \mb{G}_1$; a polynomial $f(X)\in \bFp[X]$ of degree $\leq n$

\noindent \textbf{Claim:} $a^{f(s)} = b$

\begin{enumerate}[wide, labelwidth=!, labelindent=0pt] \vs \item The Fiat-Shamir heuristic generates a challenge $\al\in \bFp^*$ (the challenge).

\noindent 2. The Prover computes a polynomial $h(X)\in \in \bFp[X]$ and an element $\be\in \bFp^*$ such that $f(X) = (X+\al)h(X)+ \be$. The Prover sends $Q:= a^{h(s)}$ to the Verifier.

\noindent 3. The Verifier computes $\be:= f(X)\Mod{(X+\al)}$ and accepts if and only if the equation \vs $$\mathbf{e}(Q, g_2^{s+\al})\cdot\mathbf{e}(a, g_2^{\be})  = \mathbf{e}(b, g_2)$$ holds.\qed \end{enumerate}



\noin We use the last protocol to modify the proof of membership for a data set.

\begin{Prot} Protocol for set membership.\end{Prot} \vspace{-0.3cm}

\noindent \textbf{Parameters :} A pairing ${\bf{e}}: \mb{G}_1\times \mb{G}_2\lra \mb{G}_T$ of groups of prime order $p$; generators $g_1, g_2$ of $\mb{G}_1$, $\mb{G}_2$ respectively; a trapdoor $s\in \bFp^*$ such that the Prover possesses the elements $\{g_1^{s^i}, g_2^{s^i}:\; 0\leq i\leq n \}$ and the Verifier possesses the set $\{g_1, g_2, g_1^s, g_2^s \}$ 

\noindent \textbf{Inputs:} Data sets $\mc{D}$, $\mc{D}_0$; the accumulated digest $\mr{Acc}(D)$

\noindent \textbf{Claim:} $\mc{D}_0\sub \mc{D}$.\vspace{0.1cm}

\normalfont \noin 1. The Prover computes the polynomial $f_0(X):= \prod\limits_{d_0\in \mc{D}_0}(X+d_0)$.

\noindent 2. The Prover computes $$\mr{Wit}(\mc{D}_0) := g_1^{\prod\limits_{d\in \mc{D}\setminus \mc{D}_0} (d+s)}.$$

\noindent 3. The Prover sends the Verifier a non-interactive \verb|PoE| for $\mr{Wit}(\mc{D}_0)^{f_0(s)} = \mr{Acc}(\mc{D})$.

\noindent 4. The Verifier computes $f_0(X)$ and accepts if and only if the \verb|PoE| is valid.\qed \\


\subsection{\fontsize{11}{11}\selectfont Pairings from elliptic curves}



\noin \textbf{The Weil number:} An elliptic curvce over a finite field $\bF _q$ of characteristic $p$ is endowed with the endomorphism \vs $$\mr{Fr}_{_E} : E\lra E\;\;,\;\;(x,y)\lra (x^p, y^p) .$$ This endomorphism is called the \textit{Frobenius} endomorphism of $E$ and satisfies a quadratic equation $X^2 - tX + q$ for some integer $t$. Furthermore, this endomorphism commutes with every endomorphism of $E$.

A Weil $q$-integer is an algebraic integer $\al$ such that $\sigma(\al)\cdot \ov{\sigma(\al}) = q$ for every automorphism $\sigma\in \absq$. Thus, the Frobenius of an elliptic curve is a Weil $q$-integer $\pi$ such that $[\bq(\pi):\bq]\leq 2$. From Honda-Tate theory, we know that the map $E\lra \mr{Fr}_{_E}$ yields a bijection \vspace{-3mm}

\[
  \{ \text{Elliptic curves } \bFq \text{ up to isogeny}  \} \;\;\lra\;\; \left\{\begin{array}{l}
    \text{Weil } q\text{-integers } \pi \text{ up to } \absq\text{-conjugacy}\\ 
    \text{such that } [\bq(\pi):\bq]\leq 2
  \end{array}\right\}
\]


\noin \textbf{Endomorphisms:} For an elliptic curve $E$, an endomorphism $\phi$ of $E$ is an algebraic map $\phi:E\lra E$. The set of endomorphisms of $E$ is called the endomorphism ring of $E$ (denoted by $\End(E)$). It has the structure of a ring with no zero-divisors that is finite dimensional over $\bz$-module. The tensor product $\End^0(E):= \End(E)\otimes_{\bz}\bq$ is called the endomorphism algebra. The center of $\End(E)$ is the subring $\bz[\pi_E]$. Similarly, the field $\bq(\pi_E)$ is the center of the division algebra $\End^0(E)$. For simplicity, we assume the field $\bFq$ has been enlarged to endure that $\End(E) = \End(E\times_{\bFq} \bFQ)$. Broadly, $\End^0(E)$ has one of two possible structures:

\noin 1. If $E$ is ordinary, $\End^0(E) = \bq(\pi_E)$ and is an imaginary quadratic field in which the prime $p$ splits. Thus, $\End(E)$ is an order in this imaginary quadratic field.

\noin 2. If $E$ is supersingular, $\pi_E = \sqrt{q} \in \bz$ and $\End^0(E)$ is the quaternion algebra $\bq_{p.\infty}$ ramified exclusively at $p$ and $\infty$. The endomorphism ring $\End(E)$ is a maximal order in $\bq_{p,\infty}$.\\

\noin \textbf{The embedding degree:} Let $E$ be an elliptic curve over a finite field $\bFq$  of characteristic $p$. Let $\pi$ be the Weil number associated to $E$. Then $\pi$ is an algebraic integer such that $\pi\cdot \ov{\pi} = q$ and $\pi+\ov{\pi}\in \bz$. Furthermore, the number of $\bFqk$-points on $E$ is given by $|(1-\pi^k)(1-\ov{\pi}^k)|$.


Now, suppose $\ell\neq p$ is a prime dividing $\# E(\bFq)$. For simplicity, assume $\ell^2$ does not divide $\# E(\bFq)$. Then the $\ell$-torsion group $E(\bFP)[\ell]$ is isomorphic to $\bz/\ell\bz \times \bz/\ell\bz$. The \textit{embedding degree} of $E$ with respect to $\ell$ is the integer $k$ such that:

\noin - $k$ is the smallest integer such that $q^k\equiv 1\Mod{\ell}$.

\noin - $k$ is the smallest integer such that all $\ell$-torsion points of $E$ are defined over the extension $\bFqk$


We denote by $\mu_{\ell}(\bF _{q^k})$ the unique cyclic subgroup of $\bF _{q^k}^*$ of order $\ell$. We now briefly describe the \textit{Tate pairings} associated with an elliptic curve over a finite field.\\ 

\subsection{\fontsize{11}{11}\selectfont Divisors}

We start out by defining divisors on elliptic curves. Most of the concepts here generalize to arbitrary smooth curves over fields. But we will confine our focus to divisors on elliptic curves over finite fields.

Let $E$ be an elliptic curve over a finite $F$ with Weierstrass equation $r(X,Y) = 0$. Let $\ov{F}$ denote the algebraic closure of $F$. We denote by $E(\ov{F})$ the group of $\ov{F}$-points of $E$. 

A \textit{divisor} $D$ on $E$ is a formal sum $\slim_{P\in E}n_{D,P}(P) $ where the $n_P$ are integers that are non-zero for at most finitely many points $P$. The set of points $P$ such that $n_{D,P}\neq 0$ is called the \textit{support} of $D$ and is denoted by $\mr{supp}(D)$. The sum $\slim_{P\in E}n_{D,P}$ is called the \textit{degree} of $D$. 

The divisor $\epsilon(D):= \slim_{P\in E, n_{D,P}\geq 0} n_{D,P}P $ is called the \textit{effective} part of $D$. The divisor $D$ is said to be \textit{effective} if $\epsilon(D) = D$. Clearly, any divisor can be realized as the difference between two effective divisor.

Thus, the set of divisors on $E$ has the structure of an abelian group and is naturally endowed with an action by $\absf$. We say a divisor $D$ is defined over $K$ if $D = \sigma(D)$ for every $\sigma\in \absf$. The set of divisors defined over $F$ is denoted by $\mr{Div}_F(E)$. This is a subgroup of $\mr{Div}(E)$.

The degree zero divisors defined over $K$ form a subgroup of $\mr{Div}_K(E)$. We denote this subgroup by $\mr{Div}_K^0(E)$. The function field of $E$ over $F$ is the field of fractions $F(E)$ of the integral domain $K[X,Y]/r(X,Y).$ The divisor of a function $f\in F(E)$ is given by $\divv(f):= \slim_{P} m_{f,P}(P)$ where $m_{f,P}$ is the multiplicity of $P$ as a zero of $f$. A divisor is said to be \textit{principal} if it occurs as the divisor of some rational function. The set of divisors of functions has the structure of a group. Furthermore, a divisor $D= \slim_{P\in E}m_{D,P}(P)$ is principal if and only if $\slim_{P\in E}m_{D,P} = 0$ and $\slim_{P\in E}n_{D,P}(P) = \infty$. Thus, every principal divisor has degree zero. We denote the set of principal divisors by $\mr{Prin}(E)$. This has the structure of an abelian group.

For a function $f\in \bFq(E)$ and a divisor $D= \slim_{P} m_{f,P}P$ such that $D$, $(f)$ have disjoint supports, we have \vs $$f(D) = \pl_{P} f(P)^{m_{f,P}} .$$ The \textit{Weil reciprocity law} states that for non-zero functions $f$, $g$ on the curve with disjoint supports, \vs $$f((g)) = g((f)) .$$ We skip the details but note that this lie at the heart of many of the proofs of the pairing properties of elliptic curves.\\

For distinct points $P$, $Q$ on the curve, we denote the line passing through them by $\mc{L}_{P,Q}$ (or $\mc{L}_{Q, P}$). We denote the tangent line to the curve at the point $P$ by $\mc{L}_{P, P}$. We denote the vertical line passing through $P$ (and $-P$) by $\mc{V}_P$ (or $\mc{V}_{-P}$). \\



\noin \textbf{Pairings:} Let $E$ be an elliptic curve over a finite field $\bFq$  of characteristic $p$. Let $\pi$ be the Weil number associated to $E$. Then $\pi$ is an algebraic integer such that $\pi\cdot \ov{\pi} = q$ and $\pi+\ov{\pi}\in \bz$. Furthermore, the number of $\bFqk$-points on $E$ is given by $|(1-\pi^k)(1-\ov{\pi}^k)|$.


Now, suppose $\ell\neq p$ is a prime such that $\# E(\bFq)\in \ell\bz\setminus \ell^2\bz$. Then the $\ell$-torsion group $E(\bFP)[\ell]$ is isomorphic to $\bz/\ell\bz \times \bz/\ell\bz$. Let $k$ be the embedding degree of $E$ with respect to $\ell$. We denote by $\mu_{\ell}(\bF _{q^k})$ the unique cyclic subgroup of $\bF _{q^k}^*$ of order $\ell$.\\

\noin \textbf{The Tate pairing:} Let $P\in E(\bFq)[\ell]$. Then there exists a rational function $f_{\ell,P}$ with divisor $(f) = \ell(P) - \ell(\infty)$. Let $Q\in E(\bFq)$ be any reprsentative in the equivalence class $E(\bF _ {q^k})/\ell E(\bF _ {q^k})$. Let $D_Q$ be a degree zero divisor defined over $\bF _ {q^k}$ that is equivalent to $(Q)-(\infty)$ but whose support is disjoint from that of $(f_{\ell,P})$. The (intermediate) Tate pairing $t_{\ell}$ is a map \vs $$t_{\ell}: E(\bF _ {q^k})[\ell]\times E(\bF _ {q^k})/\ell E(\bF _ {q^k})\;\lra\; \bF _ {q^k}^*/(\bF _ {q^k}^*)^{\ell}\;\;,\;\;(P,Q)\mapsto f_{\ell,P}(D_Q) \vs .$$ This pairing is bilinear and non-degenerate and the target group is the quotient group $\bF _ {q^k}^*/(\bF _ {q^k}^*)^{\ell}$ which is cyclic of order $\ell$. 

A shortcoming of this pairing is that it is not entirely deterministic. Different parties may compute values that coincide under this notion of equivalence   but are distinct in a stricter sense. To this end, we modify the definition by defining \vs $$T_{\ell} : E(\bF _ {q^k})[\ell]\times E(\bF _ {q^k})/\ell E(\bF _ {q^k})\;\;\lra\;\; \mu_{\ell}(\bF _ {q^k})\vs $$ \vs $$(P,Q)\;\;\mapsto\;\; t_{\ell}(P,Q)^{(q^k-1)/\ell} = f_{\ell, P}(D_Q)^{(q^k-1)/\ell}. \vs $$  

\noin The last part is a (rather expensive) exponentiation in the finite field $\bF _ {q^k}$ and is called the \textit{final exponentiation} for Tate pairings. It is one fo the two components of a Tate pairing, the other being the Miller loops which we describe below. 



    
\bigskip



\noin \textbf{The Weil pairing:} Let $P, Q \in E(\bFqk)[\ell]$ and let $D_P$, $D_Q$ be divisors with disjoint supports such that $D_P \sim (P) - (\infty) $, $D_Q \sim (Q) - (\infty) $. There exist rational functions $f_{\ell,P}$, $g_{\ell,P}$ such that $(f_{\ell,P}) = \ell D_P$, $(g_{\ell,P}) = \ell D_Q$. The Weil pairing is a map \vs $$w_{\ell}: E(\bFqk)[\ell]\times E(\bFqk)[\ell]\;\lra \; \mu_{\ell}(\bFqk) $$ defined by \vs $$w_{\ell}(P,Q):= \frac{f(D_Q)}{g(D_P)}. $$

The Weil pairing is bilinear, non-degenerate and alternating. Furthermore, $w_{\ell}(P,Q) = 1$ if and only if $P$ and $Q$ lie in the same cyclic group of order $\ell$. Thus, choosing $r$-torsion points $P$, $Q$ that generate distinct cyclic groups $\mb{G}_1$, $\mb{G}_2$ of order $\ell$ and setting $\mb{G}_T:= \mu_{\ell}(\bFqk)$ yields a non-degerate bilinear pairing \vs $$\e: \mb{G}_1\times\mb{G}_2 \;\lra\; \mb{G}_T .$$    



\begin{comment}

The (modified) Tate pairing is the map \vs $$\e: E[\ell]\times E[\ell] \lra \mu_{\ell}(\bF _{q^k})$$ defined as follows. For $P,Q \in E[\ell]$, let $f_P$ be any function such that $\divv(f_P) = n(P) - n(\infty)$.

Choose any point $R\in E[\ell]\setminus \{\infty, P, Q, P-Q \}$ and set $D_Q:= (Q+R)-(R)$. By construction, the divisors $D$ and $\divv(f_P)$ have disjoint supports. Now, we define \vs $$\e(P,Q):= f_P(D_Q)^{(q^k-1)/\ell} = \left( \frac{f_P(Q+R)}{f_P(R)}  \right)^ {(q^k-1)/\ell}.$$ The Tate-pairing is \textit{well-defined} in the sense that the value of $\e(P,Q)$ does not depend on the choice of $f_P$ or $R$. Furthermore, it is bilinear and non-degenerate.\\ \end{comment}

\noin \textbf{The security parameter:} The integer $\frac{\ell-1}{k}$ is called the security parameter of $E$ with respect to $\ell$. The strongest attacks against the discrete logarithm problem in the $\ell$-torsion subgroup of $E$ are 

\noin - the MOV (Menezes Okamoto Vanstone) attack which has runtime complexity $\mbf{O}\big(\frac{\ell-1}{k}).$ \\
- the Kim-Barbelescu number field sieve attack that exploits the discrete log in the target group $\bG_T$.

Thus, the integer $\frac{\ell-1}{k}$ has to be large enough for the scheme to be secure. On the other hand, the integer $q^k$ has to be small enough for the arithmetic in the field $\bF _{q^k}$ to be reasonably efficient. It appears that the golden mean  lies at ordinary elliptic curves with embedding degree $12$. For $128$-bit security, we need the elliptic curve to be defined over a $380$-bit prime and for the prime $\ell$ to be a $256$-bit prime.  

The curve $E$ is said to be \textit{pairing-friendly} if $\# E(\bFq)$ has a prime divisor $\ell$ such that:

\noin - $\ell\geq \sqrt{q}$\\
- the embedding degree of $E$ with respect to $\ell$ is  $\leq \log_2(\ell)/8$

In practice, the curve most widely used for SNARKs is the BLS12-381, thus named because it is defined over a $381$-bit prime field $\bFp$ and $\# E(\bFp)$ has a $256$-bit prime divisor $\ell$ such that $E$ has embedding degree $12$ with respect to $\ell$.\\ 




\noin \textbf{Miller's algorithm:} We now describe Miller's algorithm which allows us to compute pairings \textit{efficiently}. This elegant algorithm is the reason pairings are of practical value rather than purely of theoretical interest. A naive approach would mean $\bO(\ell)$ operations in the elliptic curve over a $\bFp$, which would be impractical when $\ell \approx 2^{256}$ and $p\approx 2^{381}$. Miller's algorithm allows us to compute the parings with $\bO(\log(\ell))$  operations in the elliptic curve.

In practice, the best optimized Tate pairing is substantially faster than the best optimized Weil pairing. Hence, we typically use Tate pairings when the     effective runtime is crucial, as is the case with SNARKs.

As before, let $P$ be a point on the elliptic curve $E$. The key ingredient is to determine a function $f_{\ell,P}$ with divisor $\ell(P)-\ell(\infty)$. For every integer $i\geq 1$, the $f_{i,P}$ be a function whose divisor is $\divv(f_i) = i(P)	- ([i]P) - (i-1)(\infty)$. In particular, $f_1 = 1$ and $f_{\ell} = f_{P}$. The following relation enables efficient computation of $f_{\ell,P}$


\begin{Lem} Let $P\in E[\ell]$ and let $i$, $j$ be integers $\geq 1$. Let $\mc{L}_{[i]P, [j]P}$ be the line through $[i]P$ and $[j]P$. Let $\mc{V}_{[i+j]P}$ be the vertical line through $[i+j]P$. Then $f_{i+j,P} = f_{i,P}f_{j,P}\frac{\mc{L}_{[i]P, [j]P}}{\mc{V}_{[i+j]P}}$.\end{Lem}

\begin{prf} To be added.  \end{prf}

It is important to note that the degree of $f_{n,P}$ grows linearly with $n$ (en route to $\ell$). Hence, the degree of the rational function $f_{n,P}\in \bFqk(E)$ eventually becomes too large for $f_{n,P}\in \bFqk(E)$ to be stored. Miller's algorithm circumvents this bottleneck by storing the evaluation $f_{n,P}(D_Q)$ at the divisor $D_Q$ instead of $f_{n,P}$. 



\bigskip

\begin{mdframed} \textbf{Miller's algorithm to compute  the Tate pairing $\e(P,Q)$} \vspace{0.15cm}

\noin \textbf{Input:} $P\in E(\bFqk)[\ell]$; $D_Q\sim (Q)-(\infty)$ with support disjoint from $(f_{\ell,P})$; the binary representation $\ell = (r_{n-1}\cdots r_1 r_0)_2$ with $r_{n-1} = 1$ \vspace{0.15cm}

\noin \textbf{Output:} $f_{\ell,P}(D_Q)\gets f$ \vspace{0.15cm}

\begin{enumerate}[wide, labelwidth=!, labelindent=0pt]\vs \item $R\gets P$, $f\gets 1$

\item for $i = n-2$ down to $0$ do:

\item Compute the line functions $\mc{L}_{R,R}$ and $\mc{V}_{[2]R}$ for doubling $R$.

\item $R\gets [2]R$

\item $f\gets f^2\cdot \frac{\mc{L}_{R,R}}{\mc{V}_{[2]R}}(D_Q)$

\item if $r_i =1$ then 

\item Compute the line functions $\mc{L}_{R,P}$ and $\mc{V}_{R+P}$ for adding $R$ and $P$

\item $R\gets R+P$

\item $f\gets f\cdot \frac{\mc{L}_{R,P}}{\mc{V}_{R+P}}(D_Q)$

\item end if

\item end for

\item return $f^{(q^k-1)/{\ell}}$ \qed \end{enumerate} \end{mdframed}






\subsection{\fontsize{11}{11}\selectfont Summary}

There is consensus that the the III pairings are faster than type I and type II pairings. Furthermore, Tate pairings are faster than Weil pairings. Hence, it is optimal to use a Tate pairing for an ordinary pairing-friendly elliptic curve. The curve most suitable for this purpose seems to be the BLS12-381 curve.

The fundamental computation in elliptic curve cryptography is the scalar multiplication $m\cdot P$ for an integer $m$ and an elliptic curve point $P$. This point is computed in runtime $\bO(\log(m))$ via a sequence of point doublings and point additions. One of the components of a Tate pairing is the Miller loop , which largely an extension of the scalar multiplication computation. The other key component in a Tate pairing is the final exponentiation which is a rather expensive exponentiation operation in a finite field of size $p^k$ .  

In pairing-based SNARKs such as PLONK, Groth16 etc, the Verifier's work is dominated by pairing computations. Thus, optimizing pairings is crucial for applications of SNARKs to blockchains.











\subsection{\fontsize{11}{11}\selectfont Symbols}

\noin $(f)$: divisor of the function $f$ \vspace{0.1cm}

\noin $\infty$: The point at infinity \vspace{0.1cm}

\noin $D_P$: the divisor $(P)-(\infty)$ \vspace{0.1cm}

\noin $E(K)$: the group of $K$-valued points of $E$ \vspace{0.1cm}

\noin $E[n]$: the $n$-torsion subgroup of $E$ \vspace{0.1cm}

\noin $\mc{L}_{P,Q}$: the line passing through $P$ and $Q$ if $P\neq Q$; the tangent line at $P$ if $P = Q$ \vspace{0.1cm}

\noin $\mc{V}_{P}$: the vertical line passing through $P$ \vspace{0.1cm}

\noin $T_{\ell}(P,Q)$: the order $\ell$ reduced Tate pairing \vspace{0.1cm}

\noin $t_{\ell}(P,Q)$: the intermediate order $\ell$ Tate pairing \vspace{0.1cm}

\noin $w_{\ell}(P,Q)$: the order $\ell$ Weil pairing  \vspace{0.1cm}

\noin BLS: Boneh-Lynn-Scott \vspace{0.1cm}

\noin $\mr{Div}^0(E)$: group of degree zero dvisors on $E$ \vspace{0.1cm}

\noin $\mr{ord}_P(f)$: the multiplicity of $f$ at $P$ on $E$ \vspace{0.1cm}

\noin $\End(E)$: The endomorhpism ring of $E$  \vspace{0.1cm}

\noin $\End^0(E)$: The endomorhpism algebra of $E$ \vspace{0.1cm}

\noin $\absf$: The absolute Galois group of $F$ \vspace{0.1cm}


\end{document}