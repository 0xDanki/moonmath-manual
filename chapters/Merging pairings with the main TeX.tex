% with font size 10, I think there is just too much Information per page.
\documentclass[a4paper, 11pt]{scrreprt}

% border sizes
\setlength{\topmargin}{0.0in}
\setlength{\oddsidemargin}{0.33in}
\setlength{\textheight}{9.0in}
\setlength{\textwidth}{6.0in}

%fonts
% times is the font I (Mirco) thinks looks the most calm, ordered and math-textbook like
\usepackage{times}
% use times style for mathmode, too
\usepackage{mathptmx}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

\usepackage[linewidth=1pt]{mdframed}

\usepackage{amssymb,amsmath,amsthm,mathrsfs,xspace,multicol}
%\usepackage{polydiv}
\usepackage{amscd}
\usepackage[all]{xy}
%\usepackage{algpseudocode}
\usepackage{clrscode}
\usepackage{enumitem} % for personalizing enumeration with itemize


\usepackage{verbatim}

% the sagetex evironment
\usepackage{sagetex}
\usepackage{xcolor}
% color of the sagecommandline-tex-environment
\lstset{language=Sage,
commentstyle={\ttfamily\color{green}},
keywordstyle={\ttfamily\color{blue}\bfseries},
stringstyle ={\ttfamily\color{dgraycolor}\bfseries},
tabsize = 4,
basicstyle={\small \ttfamily},
backgroundcolor= \color{gray!10},
}


%Load the following packages last
\usepackage{hyperref} % for all kinds of linke
\usepackage{cleveref}%must be loaded after `hyperref`


%margins
\usepackage[a4paper, margin=2.5cm]{geometry}


%bibliography management
\usepackage{natbib}
\bibliographystyle{unsrtnat}%we can discuss what style we want to use

%math typesetting
\usepackage{amsfonts}

% Table of Contents

\setcounter{tocdepth}{4}

%	Macros
% Fields and categories
\newcommand{\C}{\mathbb{C}}
\newcommand{\G}{\mathbb{G}}
\newcommand{\Prim}{\mathbb{P}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\NN}{\mathbb{N}_0}
\newcommand{\K}{\mathbb{K}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\X}{\mathfrak{X}}
\newcommand{\Oinf}{\mathcal{O}}

\newcommand{\Zdiv}[2]{#1 \text{ div } #2}
\newcommand{\Zmod}[2]{#1 \text{ mod } #2}
\newcommand{\kongru}[3]{#1 \equiv #2 \quad \text{( mod } #3 \text{ )}}

% inline code
\newcommand{\icode}[1]{\lstinline{#1}}





% These establish different environments for stating Theorems, Lemmas, Remarks, etc.

\newtheorem{Thm}{Theorem}[section]
\newtheorem{Prop}[Thm]{Proposition}
\newtheorem{Lem}[Thm]{Lemma}
\newtheorem{Corr}[Thm]{Corollary}
\newtheorem{Algo}[Thm]{Algorithm}
\newtheorem{Example}[Thm]{Example}

\newtheorem{Prot}[Thm]{Protocol}

\newtheorem{Def}{Definition}[section]

\newtheorem{Fact}{Fact}[section]

\newtheorem{Ass}{Assumption}[section]

\newtheorem{Rem}[Thm]{Remark}

\begin{comment} \declaretheorem{theorem} 
\declaretheoremstyle[%
  spaceabove=-2pt,%
  spacebelow=8pt,%
  headfont=\normalfont\itshape,%
  postheadspace=1em,%
  qed=\qedsymbol%
]{mystyle} 
\declaretheorem[name={Proof},style=mystyle,unnumbered,
]{prf}

\declaretheorem[name={Step},style=bold,unnumbered, %postheadspace=1em,%
qed=\qedsymbol%
]{prf1} \end{comment}

\numberwithin{equation}{section}


%\renewcommand{\labelenumi}{(\alphaph{enumi})}

% End environments 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Now we're ready to start
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

















\DeclareOldFontCommand{\bf}{\normalfont\bfseries}{\mathbf}



\newcommand{\bc}{\mathbb C}
\newcommand{\bF}{\mathbb F}
\newcommand{\bH}{\mathbb H}
\newcommand{\bn}{\mathbb N}
\newcommand{\bz}{\mathbb Z}
\newcommand{\bp}{\mathbb{P}}
\newcommand{\bq}{\mathbb Q}
\newcommand{\br}{\mathbb R}
\newcommand{\bS}{\mathbb S}

\newcommand{\bFp}{\mathbb{F}_p}
\newcommand{\bFP}{\ov{\mathbb{F}}_p}
\newcommand{\bFl}{\mathbb{F}_l}
\newcommand{\bFq}{\mathbb{F}_q}
\newcommand{\bFqk}{\mathbb{F}_{q^k}}
\newcommand{\bFQ}{\ov{\mathbb{F}}_q}
\newcommand{\bFpk}{\mathbb{F}_{p^k}}


\newcommand{\pl}{\prod\limits}
\newcommand{\slim}{\sum\limits}
\newcommand{\bcup}{\bigcup\limits}
\newcommand{\bcap}{\bigcap\limits}

\newcommand{\ttt}{\texttt}

\newcommand{\bT}{\mathbf T}
\newcommand{\bTl}{\mathbf T_{{\bq_l}}}
\newcommand{\bTlbar}{\mathbf T_{{\qbar_l}}}

%\newcommand{\G}{\mathcal G}

\newcommand{\Gal}{\mathrm{Gal}}
\newcommand{\scl}{\mathcal L}

\newcommand{\W}{\mathcal W}
\newcommand{\WA}{\mathcal{W}_{A_v}}

\newcommand{\zbar}{\overline {\mathbb{Z}}}
\newcommand{\qbar}{\overline {\mathbb{Q}}}

\newcommand{\Fbar}{\overline {F}}
\newcommand{\Kbar}{\overline {K}}

\newcommand{\bark}{\overline {k}}

\newcommand{\bg}{\mathbb{G}}
\newcommand{\bG}{\mathbb{G}}

\newcommand{\st}{\mathrm{st}}

\newcommand{\uni}{\mathrm{uni}}

\newcommand{\lcm}{\mathrm{lcm}}

\newcommand{\negl}{\ttt{{negl}}}

\newcommand{\pr}{\protect}

\newcommand{\Acc}{\mbf{Acc}}

\newcommand{\sett}{\ttt{Set}}

\newcommand{\mult}{\mr{mult}}
\newcommand{\mul}{\mr{mult}}


\newcommand{\absq}{\mathrm{Gal}_{\bq}}
\newcommand{\absql}{\mathrm{Gal}_{\bq_l}}
\newcommand{\absqp}{\mathrm{Gal}_{\bq_p}}
\newcommand{\absqph}{\mathrm{Gal}_{\bq_{p^h}}}

\newcommand{\absf}{\mathrm{Gal}_F}
\newcommand{\absfv}{\mathrm{Gal}_{F_v}}
\newcommand{\abse}{\mathrm{Gal}_E}
\newcommand{\absk}{\mathrm{Gal}_K}
\newcommand{\absl}{\mathrm{Gal}_L}

\newcommand{\Div}{\mathrm{Div}}
\newcommand{\divv}{\mathrm{div}}




\newcommand{\Gm}{\mathbb{G}_m}

\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\rarrrow}{\rightarrow}
\newcommand{\lra}{\longrightarrow}
\newcommand{\llra}{\longleftrightarrow}
\newcommand{\xra}{\xrightarrow}
\newcommand{\hra}{\hookrightarrow}
\newcommand{\LRA}{\Longleftrightarrow}
\newcommand{\RA}{\Longrightarrow}
\newcommand{\harrow}{\hookrightarrow}
\newcommand{\lhra}{\hooklongrightarrow}

\newcommand{\imp}{\Longrightarrow}

\newcommand{\impop}{\overset{\;\;\;\;\mr{o.p.}\;\;\;\;}{\Longrightarrow}}

\newcommand{\eqlam}{\equiv_{\lam}}

\newcommand{\lameq}{\equiv_{\lam}}


\newcommand{\bs}{\backslash}
\newcommand{\ti}{\tilde}
\newcommand{\wti}{\widetilde}
\newcommand{\mf}{\mathfrak}
\newcommand{\mc}{\mathcal}
\newcommand{\mb}{\mathbb}
\newcommand{\mbf}{\mathbf} 
\newcommand{\mr}{\mathrm}
\newcommand{\mfp}{\mathfrak{p}}
\newcommand{\tmfp}{\ti{\mc{P}}}
\newcommand{\mfm}{\mathfrak{m}}
\newcommand{\mfn}{\mathfrak{n}}

\newcommand{\e}{\mathbf{e}}

\newcommand{\pro}{\protect\verb}


\newcommand{\mfl}{\mathfrak{l}}

\newcommand{\zetamn}{\zeta_{mn}}

\newcommand{\setm}{\setminus}
\newcommand{\sm}{\setminus}

\newcommand{\Br}{\mr{Br}}

\newcommand{\Jac}{\mr{Jac}}

\newcommand{\al}{\alpha}
\newcommand{\be}{\beta}
\newcommand{\ga}{\gamma}
\newcommand{\Ga}{\Gamma}
\newcommand{\Gam}{\Gamma}
\newcommand{\lam}{\lambda}
\newcommand{\lamb}{\lambda}
\newcommand{\Lam}{\Lambda}
\newcommand{\Lamb}{\Lambda}
\newcommand{\del}{\delta}
\newcommand{\Del}{\Delta}
\newcommand{\si}{\sigma}
\newcommand{\tsi}{\tilde{\sigma}}
\newcommand{\om}{\omega}
\newcommand{\Om}{\Omega}
\newcommand{\what}{\widehat}
\newcommand{\weck}{\widecheck}


\newcommand{\ov}{\overline}


\newcommand{\bzlam}{\bz_{(\lam)}}

\newcommand{\bzs}{\bz_{\mc{S}}}
\newcommand{\bzS}{\bz_{\mc{S}}}

\newcommand{\sub}{\subseteq}

\newcommand{\nsub}{\nsubseteq}

\newcommand{\dlog}{\mbf{dlog}}

\newcommand{\Prob}{\ttt{Pr}}

\newcommand{\bO}{\mbf{O}}

\newcommand{\mP}{\mc{P}}

\newcommand{\A}{\mc{A}}

\newcommand{\V}{\mc{V}}

\newcommand{\mcM}{\mc{M}}


\newcommand{\Com}{\ttt{Com}}

\newcommand{\vs}{\vspace{-2mm}}

\newcommand{\para}{\;\;\;\;\;\;}

\newcommand{\noin}{\noindent}

\newcommand{\op}{overwhelming probability}

\newcommand{\np}{negligible probability}

\newcommand{\non}{non-interactive proof}

\newcommand{\nons}{non-interactive proofs}

\newcommand{\sta}{\stackrel{?}{=}}

\newcommand{\Mod}[1]{\ (\mathrm{mod}\ #1)}

\newcommand{\LCM}{\mbf{lcm}}

\newcommand{\GCD}{\mbf{gcd}}

\newcommand{\intt}{\ttt{int}}

\newcommand{\un}{\ttt{uni}}

\newcommand{\new}{\ttt{new}}

\newcommand{\Ext}{\ttt{Ext}}

\newcommand{\E}{\mc{E}}



\newcommand{\mbr}{\mbf{r}}

\newcommand{\mule}{\mu_{\ell}}






















% theorem styles
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[subsection]
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{conjecture}{Conjecture}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}

% algorithmicx commands
%\algnewcommand\algorithmicinput{\textbf{Statement:}}
%\algnewcommand\Statement{\item[\algorithmicinput]}

\title{Moonmath manual}
\author{TechnoBob and the Least Scruples crew}
\date{\today}

\begin{document}

\maketitle

Lorem \textbf{ipsum} dolor sit amet, consectetur adipiscing elit. Pellentesque semper viverra dictum.  Fusce interdum venenatis leo varius vehicula. Etiam ac massa dolor. Quisque vel massa faucibus, facilisis nulla nec, egestas lectus. Sed orci dui, egestas non felis vel, fringilla pretium odio. \textit{Aliquam} vel consectetur felis. Suspendisse justo massa, maximus eget nisi a, maximus gravida mi.

Here is a citation for demonstration: \cite{lamport1982the}

\include{chapters/intro-moonmath}
\include{chapters/zoo-moonmath}
\include{chapters/preliminaries-moonmath}
\include{chapters/number-theory-moonmath}
\include{chapters/computational-models-moonmath}
\include{chapters/exercise-solutions-moonmath}

\bibliography{moonmath}%use `moonmath.bib` to look for references, and print bibliography at this point in the document










\title{Pairings}
\author{}
\date{}
 
\maketitle


In this chapter, we discuss \textit{pairings}, which form the basis of several zk-SNARKs and other zero knowledge proof schemes. The SNARKs derived from pairings have the advantage of constant-sized proof sizes, which is crucial to blockchains. 

We start out by defining pairings and discussing a simple application which bears some resemblance to the more advanced SNARKs. We then introduce the pairings arising from elliptic curves and describe Miller's algorithm which makes these pairings practical rather than just theoretically interesting.


\subsection{\fontsize{11}{11}\selectfont Bilinear Pairings}


\begin{Def} \normalfont For finite abelian groups $\mb{G}_1$, $\mb{G}_2$, $\mb{G}_T$, a \textit{pairing} $$\mathbf{e}:\mb{G}_1\times \mb{G}_2 \lra \mb{G}_T$$ is a map with the following properties.

\noindent 1. Bilinearity: $\mathbf{e}(x_1+x_2,y_1+y_2) = \mathbf{e}(x_1, y_2)\cdot\mathbf{e}(x_1, y_2)\cdot\mathbf{e}(x_2, y_1)\cdot\mathbf{e}(x_2, y_2)$\\ $\forall\; x_1,x_2\in \mb{G}_1,\; y_1,y_2\in \mb{G}_2$.

\noindent 2. Non-degeneracy: The image of $\mathbf{e}$ is non-trivial.

\noindent 3. Efficient computability.\end{Def}

In pairing-based cryptography, we typically work in settings where the groups $\mb{G}_1$, $\mb{G}_2$, $\mb{G}_T$ are cyclic of order $p$ for some $256$-bit prime $p$ so as to have a $128$-bit security level. Such pairings $\mathbf{e}:\mb{G}_1\times \mb{G}_2 \lra \mb{G}_T$ are classified into three types:

\noindent - Type $\mr{I}$: $\mb{G}_1 = \mb{G}_2$.

\noindent - Type $\mr{II}$: $\mb{G}_1 \neq \mb{G}_2$ but there is an \textit{efficiently computable} isomorphism between $\mb{G}_1$ and $\mb{G}_2$.

\noindent - Type $\mr{III}$: There is no \textit{efficiently computable} isomorphism between $\mb{G}_1$ and $\mb{G}_2$.

In particular, for elements $x_1,y_1\in \mb{G}_1$, $x_2,y_2\in \mb{G}_2$, we have $\ e(x_1,y_1) = \e(x_2,y_1)\in \mb{G}_T$ if and only if there exists an integer $s\in [0,p-1]$ such that $y_1 = x_1^s$ and $y_2 = x_2^s$. This simple fact is deceptively powerful and lies at the heart of several zero-knowledge proof schemes. In all of the existing pairing based SNARKs and zero knowledge proof systems, the pairings are performed by the \textit{Verifier} rather than the Prover. Thus, it is fundamentally important for the pairings to be efficient. 


At present, the only efficient pairings that we know of are those arising from (Jacobians of) hyperelliptic curves over finite fields. The most efficient of these are the ones arising from elliptic curves, i.e. hyperelliptic curves of genus one. The fact that elliptic curves - which were pivotal to cryptography even before pairings gained traction - are the best known source of pairings seems to be a happy coincidence.



\subsubsection{\fontsize{11}{11}\selectfont Cryptographic assumptions}



We state the computationally infeasible problems that the security of pairing-based SNARKs hinges on.

\begin{Ass} {\normalfont \textbf{{$n$-strong Diffie Hellman assumption:}}} Let $\mb{G}$ be a cyclic group of prime order $p$ generated by an element $g$, and let $s \in \bFp^*$. Any probabilistic polynomial-time algorithm that is given the set $\{g^{s^i}: 1\leq i\leq n \}$ can find a pair $(a, g^{1/(s+a)})\in \bFp^*\times \mb{G}$ with at most negligible probability.\end{Ass}

\begin{Ass} {\normalfont \textbf{{Knowledge of exponent (KEA) assumption:}}}. Let $\mb{G}$ be a cyclic group of prime order $p$ generated by an element $g$, and let $s \in \bFp^*$. Suppose there exists a PPT algorithm $\mc{A}_1$ that given the set $\{g^{s^i}, g^{s^i\al}: 1\leq i\leq n \}$, outputs a pair $(c_1, c_2)\in \mb{G}\times\mb{G}$ such that $c_2 = c_1^{\al}$. Then there exists a PPT algorithm $\mc{A}_2$ that, with overwhelming probability, outputs a polynomial $f(X)\in \bFp[X]$ of degree $\leq n$ such that $c_1 = g^{f(s)}$, $c_2 = g^{\al f(s)}$.\end{Ass}

The $n$-strong Diffie Hellman is a stronger assumption than the older and more battle-tested discrete logarithm assumption in elliptic curves. The KEA assumption is even younger and is unfalsifiable. This is one of the downsides to pairing-based SNARKs when compared to schemes such as Bulletproofs, DARK etc. that do not rely on pairings.

\subsubsection{\fontsize{11}{11}\selectfont Membership proofs}


As a warmup, we discuss a simple example of an application of pairings, namely set membership proofs. This could be though of as an application specific SNARK and is substantially simpler than the Groth16 Snark which we will discuss in subsequent chapters. But it shares a common structure with the more advanced SNARKs in that 

\noin - the Prover's work is dominated by elliptic curve operations and Fast Fourier transforms

\noin - the Verifier's work is dominated by elliptic curve pairings

\noin - the scheme requires a trusted setup for the common reference string (CRS), which in practice is generated via a multi-party computation

\noin - the security hinges on the KEA and strong Diffie-Hellman assumptions

We describe the setup in this section. Let $\mb{G}_1, \mb{G}_2, \mb{G}_T$ be cyclic groups of order $p$ for some prime $p$ such that there exists a pairing ${\bf{e}}:\mb{G}_1\times \mb{G}_2\lra \mb{G}_T$ which is \textit{bilinear}, \textit{non-degenerate} and \textit{efficiently computable}. Fix generators $g_1, g_2$ of the cyclic groups $\mb{G}_1, \mb{G}_2$ respectively. Then ${\bf{e}}(g_1,g_2)$ is a generator of $\mb{G}_T$. Unlike in the case of accumulators based on groups of unknown order, the (common) order of the groups is public. Instead, the secret trapdoor is an integer $s$ in the range $[1, p-1]$ which will serve as the private key. Unfortunately, the generation of the private key requires a trusted setup. This can be partially mitigated by using a secure multi-party computation. A Verifier needs to assume that at least one of the parties involved in the MPC is honest enough not to collude with the other participants. 

For a data set $\mc{D} = \{d_1,\cdots, d_n\}$, we define the accumulated digest \vs $$\mr{Acc}(\mc{D}):= g_1^{\prod\limits_{d\in \mc{D}} (d+s)} \in \mb{G}_1. \vs $$ For a subset $\mc{D}_0\sub \mc{D}$, the witness for $\mc{D}_0$ is defined by \vs $$\mr{Wit}(\mc{D}_0) := g_1^{\prod\limits_{d\in \mc{D}\setminus \mc{D}_0} (d+s)}. \vs $$ The Verifier then needs to check whether \vs $$\mr{Wit}(\mc{D}_0)^{\prod\limits_{d_0\in \mc{D}_0} (d_0+s)} = \mr{Acc}(\mc{D}).$$ Because of the bilinearity of the pairing, it is equivalent and usually more efficient to verify the following equation: \vs $${\bf{e}}\Big(\mr{Wit}(\mc{D}_0)\;,\; g_2^{\prod\limits_{d_0\in \mc{D}_0} (d_0+s)}\Big) = {\bf{e}}(\mr{Acc}(\mc{D}), g_2). \vs $$ Since none of the parties are aware of the value of $s$, it is necessary to broadcast the sets $\{g_1, g_1^s,\cdots , g_1^{s^n}\}$ and $\{g_2, g_2^s,\cdots , g_2^{s^n}\}$ to the Prover.

In the orignal bilinear accumulator scheme, the Verifier needs access to the sets $\{g_1, g_1^s,\cdots , g_1^{s^n}\}$ and $\{g_2, g_2^s,\cdots , g_2^{s^n}\}$. But we can modify the scheme so that the Verifier only needs the four points $\{g_1,g_1^s, g_2, g_2^s \}$ to verify membership or non-membership.

The exponent $\prod\limits_{d\in \mc{D}} (d+s)$ can be interpreted as a degree $n$ polynomial in the variable $s$. The coefficients of the polynomial are computed with a run time of ${\bf{O}} (n\log(n))$ using the Fast Fourier transform. Furthermore, the set $\bFp[X]$ of polynomials with $\bFp$-coefficients is a principal ideal domain whose maximal ideals are those generated by the irreducible polynomials. For a data set $\mc{D}$, the polynomial $f(X) = \prod\limits_{d\in \mc{D}}(X+d)$ is monic of degree $n = |\mc{D}|$. Let $c_i$ denote the coefficient of $X^i$, i.e. $f(X) = \sum\limits_{i=0}^n c_iX^i$. The coefficients can be computed in run time ${\bf{O}}(n\log(n))$ using the Fast Fourier transform. The elements \vs $$g_1^{f(s)} = \prod\limits_{i=0}^n (g_1^{s^i})^{c_i}\;\in\mb{G}_1\;\;,\;\;g_2^{f(s)} = \prod\limits_{i=0}^n (g_2^{s^i})^{c_i}\;\in\mb{G}_2 \vs $$ can then be computed by any party that possesses the elements $\{g_1^{s^i}, g_2^{s^i} :\; 0\leq i \leq n  \}$. The collision-resistance of the bilinear accumulator hinges on the $n$-Strong Diffie Hellman assumption. 


\begin{mdframed}\begin{Prot} \hypertarget{PoE}{ \textit{Proof of exponent for pairings}} $(\ttt{PoE})$:\end{Prot} 

\noindent \textbf{Parameters :} A pairing ${\bf{e}}: \mb{G}_1\times \mb{G}_2\lra \mb{G}_T$ of groups of prime order $p$; generators $g_1, g_2$ of $\mb{G}_1$, $\mb{G}_2$ respectively; a secret element $s\in \bFp^*$ such that the Prover possesses the elements $\{g_1^{s^i}, g_2^{s^i}:\; 0\leq i\leq n \}$ 

\noindent \textbf{Inputs:} $a,b\in \mb{G}_1$; a polynomial $f(X)\in \bFp[X]$ of degree $\leq n$

\noindent \textbf{Claim:} $a^{f(s)} = b$

\begin{enumerate}[wide, labelwidth=!, labelindent=0pt] \vs \item The Fiat-Shamir heuristic generates a challenge $\al\in \bFp^*$ (the challenge).

\noindent 2. The Prover computes a polynomial $h(X)\in  \bFp[X]$ and an element $\be\in \bFp^*$ such that $f(X) = (X+\al)h(X)+ \be$. The Prover sends $Q:= a^{h(s)}$ to the Verifier.

\noindent 3. The Verifier computes $\be:= f(X)\Mod{(X+\al)}$ and accepts if and only if the equation \vs $$\mathbf{e}(Q, g_2^{s+\al})\cdot\mathbf{e}(a, g_2^{\be})  = \mathbf{e}(b, g_2)$$ holds.\qed \end{enumerate}\end{mdframed}


\bigskip


\noin We use the last protocol to modify the proof of membership for a data set.



\begin{mdframed} \begin{Prot} Protocol for set membership.\end{Prot} 

\noindent \textbf{Parameters :} A pairing ${\bf{e}}: \mb{G}_1\times \mb{G}_2\lra \mb{G}_T$ of groups of prime order $p$; generators $g_1, g_2$ of $\mb{G}_1$, $\mb{G}_2$ respectively; a trapdoor $s\in \bFp^*$ such that the Prover possesses the elements $\{g_1^{s^i}, g_2^{s^i}:\; 0\leq i\leq n \}$ and the Verifier possesses the set $\{g_1, g_2, g_1^s, g_2^s \}$ 

\noindent \textbf{Inputs:} Data sets $\mc{D}$, $\mc{D}_0$; the accumulated digest $\mr{Acc}(D)$

\noindent \textbf{Claim:} $\mc{D}_0\sub \mc{D}$.\vspace{0.1cm}

\normalfont \noin 1. The Prover computes the polynomial $f_0(X):= \prod\limits_{d_0\in \mc{D}_0}(X+d_0)$.

\noindent 2. The Prover computes $$\mr{Wit}(\mc{D}_0) := g_1^{\prod\limits_{d\in \mc{D}\setminus \mc{D}_0} (d+s)}.$$

\noindent 3. The Prover sends the Verifier a non-interactive \verb|PoE| for the equation $\mr{Wit}(\mc{D}_0)^{f_0(s)} = \mr{Acc}(\mc{D})$.

\noindent 4. The Verifier computes $f_0(X)$ and accepts if and only if the \verb|PoE| is valid.\qed \end{mdframed}

\bigskip


\subsection{\fontsize{11}{11}\selectfont Pairings from elliptic curves}



\noin \textbf{The Weil number:} An elliptic curve over a finite field $\bF _q$ of characteristic $p$ is endowed with the endomorphism \vs $$\mr{Fr}_{_E} : E\lra E\;\;,\;\;(x,y)\lra (x^p, y^p) .$$ This endomorphism is called the \textit{Frobenius} endomorphism of $E$ and satisfies a quadratic equation $X^2 - tX + q$ for some integer $t$. This endomorphism commutes with every endomorphism of $E$. Furthermore, the Frobenius of any elliptic curve isogenous to $E$ satisfies the same quadratic equation.

A Weil $q$-integer is an algebraic integer $\al$ such that $\sigma(\al)\cdot \ov{\sigma(\al}) = q$ for every automorphism $\sigma\in \absq$. Thus, the Frobenius of an elliptic curve is a Weil $q$-integer $\pi$ such that $[\bq(\pi):\bq]\leq 2$. From Honda-Tate theory, we know that the map $E\lra \mr{Fr}_{_E}$ yields a bijection \vspace{-5mm}

\[
  \{ \text{Elliptic curves } \bFq \text{ up to isogeny}  \} \;\;\lra\;\; \left\{\begin{array}{l}
    \text{Weil } q\text{-integers } \pi \text{ such that } [\bq(\pi):\bq]\leq 2 \\ 
     \text{ up to conjugacy} 
  \end{array}\right\}
\]

\noin \textbf{Torsion subgroups:} For any integer $n$ prime to $p$, the $n$-torsion subgroup $E(\bFP)[n]$ is isomorphic to $\bz/n\bz\times \bz/n\bz$. For any prime power $p^k$, the $p^k$-torsion is either trivial or cyclic of order $p^k$. In the former case, $E$ is said to be \textit{supersingular} while in the latter case it is said to be \textit{ordinary}. 

As the etymology suggests, most elliptic curves are ordinary. In fact, up to isogeny, there is a unique supersingular elliptic curve over the algebraic closure $\bFP$. In fact, $E$ is supersingular if and only if:

\noin - its Weil number $\pi$ is an algebraic integer of degree $\leq 2$  

\noin - $\pi^k\in \bz$ for some integer $k\geq 1$. 

Clearly, such Weil numbers - and consequently supersingular curves - are rare. Since Type I and II pairings require supersingular elliptic curves, this is yet another reason to use type III pairings instead. \\
  

\noin \textbf{Endomorphisms:} For an elliptic curve $E$, an endomorphism $\phi$ of $E$ is an algebraic map $\phi:E\lra E$. The set of endomorphisms of $E$ is called the endomorphism ring of $E$ (denoted by $\End(E)$). It has the structure of a ring with no zero-divisors that is finite dimensional over $\bz$-module. The tensor product $\End^0(E):= \End(E)\otimes_{\bz}\bq$ is called the endomorphism algebra. The center of $\End(E)$ is the subring $\bz[\pi_{_E}]$. Similarly, the field $\bq(\pi_{_E})$ is the center of the division algebra $\End^0(E)$. For simplicity, we assume the field $\bFq$ has been enlarged to endure that $\End(E) = \End(E\times_{\bFq} \bFQ)$. Broadly, $\End^0(E)$ has one of two possible structures:\vspace{1mm}

\noin 1. If $E$ is ordinary, $\End^0(E) = \bq(\pi_{_E})$ and is an imaginary quadratic field in which the prime $p$ splits. Thus, $\End(E)$ is an order (not necessarily maximal) in this imaginary quadratic field.


\noin 2. If $E$ is supersingular, $\pi_{_E} = \sqrt{q} \in \bz$ and $\End^0(E)$ is the quaternion algebra $\bq_{p,\infty}$ ramified exclusively at $p$ and $\infty_{_E}$. The endomorphism ring $\End(E)$ is a maximal order in $\bq_{p,\infty}$.\\

\noin \textbf{Examples:} 1. Consider an elliptic curve \vs $$E:y^2 = x^3 + ax \vs $$ over a prime field $\bFp$ for some $a\in \bFp^*$. In addition to the endomorphisms \vs $$E\lra E\;\,\;,\; P\mapsto [n]P\;\;\;\;(n\in\bz),    \vs $$ the curve is endowed with the endomorphism \vs $$(x_1,y_1)\mapsto (x_1,y_1\cdot\sqrt{-1}). \vs $$ Thus, $E$ has action by $\bz[\sqrt{-1}]$.\vspace{1.5mm}

\noin 2. Consider an elliptic curve \vs $$E:y^2 = x^3 + a  $$ over a prime field $\bFp$ for some $a\in \bFp^*$. In addition to the scalar multiplication endomorphisms, the curve is endowed with the endomorphism \vs $$(x_1,y_1)\mapsto (x_1,y_1\cdot\zeta_3). \vs $$ Thus, $E$ has action by $\bz[\zeta_3]$. \vspace{1.5mm}

We note that we are abusing notation by using $\sqrt{-1}$ for a square root of $-1$ in $\ov{\bq}$ as well as $\bFP$. Likewise, we have denoted a cube root of unity in $\ov{\bq}$ and $\bFP$ by $\zeta_3$.\\

\noin \textbf{The embedding degree:} Let $E$ be an elliptic curve over a finite field $\bFq$  of characteristic $p$. Let $\pi$ be the Weil number associated to $E$. Then $\pi$ is an algebraic integer such that $\pi\cdot \ov{\pi} = q$ and $\pi+\ov{\pi}\in \bz$. Furthermore, the number of $\bFqk$-points on $E$ is given by $|(1-\pi^k)(1-\ov{\pi}^k)|$.


Now, suppose $\ell\neq p$ is a prime dividing $\# E(\bFq)$. This is equivalent to there existing a prime $\mfl$ of $\bq(\pi)$ lying over $\ell$ such that $\pi-1\in \mfl$. For simplicity, assume $\ell^2$ does not divide $\# E(\bFq)$, which means:

\noin - $\ell$ splits into two distinct prime ideals $\mfl$, $\ov{\mfl}$ in $\bq(\pi)$.

\noin - $\pi-1\notin \mfl^2\cup \ov{\mfl}$. 

The $\ell$-torsion group $E(\bFP)[\ell]$ is given by \vs $$ E(\bFP)[\ell] = E(\bFP)[\mfl] \oplus E(\bFP)[\ov{\mfl}] \cong \bz/\ell\bz \times \bz/\ell\bz . \vs $$ The \textit{embedding degree} of $E$ with respect to $\ell$ is the integer $k$ that satisfies one of the following equivalent conditions: \vspace{0.1cm}

\noin 1. $k$ is the smallest integer such that $q^k\equiv 1\Mod{\ell}$.

\noin 2. $k$ is the smallest integer such that $\ov{\pi}^k\equiv 1\Mod{\mfl}$ \vspace{0.5mm}


\noin 3. $k$ is the smallest integer such that all $\ell$-torsion points of $E$ are defined over the extension $\bFqk$. 

\noin 4. $\Phi_k(q)\equiv 0\Mod{\ell}$ where $\Phi_k(X)$ is the $k$-th cyclotomic polynomial.


We denote by $\mu_{\ell}(\bF _{q^k})$ the unique cyclic subgroup of $\bF _{q^k}^*$ of order $\ell$. For a randomly chosen elliptic curve $E$, the embedding degree with respect to any prime dividing $\# E(\bFq)$ is quite large. In fact, the embedding degree is of the same order of magnitude as $q$. Elliptic curves that are amenable to pairings (aka pairing-friendly curves) are rare.

We now briefly describe the pairings associated with an elliptic curve over a finite field. To this end, we first describe divisors on curves.\\ 

\subsection{\fontsize{11}{11}\selectfont Divisors}

We start out by defining divisors on elliptic curves. Most of the concepts here generalize to arbitrary smooth curves over perfect fields. But we will confine our focus to divisors on elliptic curves over finite fields.

Let $E$ be an elliptic curve over a finite $F$ with Weierstrass equation $r(X,Y) = 0$. Let $\ov{F}$ denote the algebraic closure of $F$. We denote by $E(\ov{F})$ the group of $\ov{F}$-points of $E$. 

A \textit{divisor} $D$ on $E$ is a formal sum $\slim_{P\in E}n_{D,P}(P) $ where the $n_P$ are integers that are non-zero for at most finitely many points $P$. The set of points $P$ such that $n_{D,P}\neq 0$ is called the \textit{support} of $D$ and is denoted by $\mr{supp}(D)$. The sum $\slim_{P\in E}n_{D,P}$ is called the \textit{degree} of $D$. 

The divisor $\epsilon(D):= \slim_{P\in E, n_{D,P}\geq 0} n_{D,P}P $ is called the \textit{effective} part of $D$. The divisor $D$ is said to be \textit{effective} if $\epsilon(D) = D$. Clearly, any divisor can be realized as the difference between two effective divisors.

Thus, the set of divisors on $E$ has the structure of an abelian group and is naturally endowed with an action by $\absf$. We say a divisor $D$ is defined over $K$ if $D = \sigma(D)$ for every $\sigma\in \absf$. The set of divisors defined over $F$ is denoted by $\mr{Div}_F(E)$. This is a subgroup of $\mr{Div}(E)$.

The degree zero divisors defined over $F$ form a subgroup of $\mr{Div}_F(E)$. We denote this subgroup by $\mr{Div}_F^0(E)$. The \textit{function field} of $E$ over $F$ is the field of fractions $F(E)$ of the integral domain $F[X,Y]/r(X,Y).$ The divisor of a function $f\in F(E)$ is given by $\divv(f):= \slim_{P} m_{f,P}(P)$ where $m_{f,P}$ is the multiplicity of $P$ as a zero of $f$. 

A divisor is said to be \textit{principal} if it occurs as the divisor of some rational function. The set of divisors of functions has the structure of a group. Furthermore, a divisor $D= \slim_{P\in E}m_{D,P}(P)$ is principal if and only if $\slim_{P\in E}m_{D,P} = 0$ and $\slim_{P\in E}n_{D,P}(P) = \infty_{_E}$. Thus, every principal divisor has degree zero. We denote the set of principal divisors by $\mr{Prin}(E)$. This is a subgroup of $\mr{Div}^0(E)$.

The quotient $\mr{Div}^0(E)/\mr{Prin}(E)$ is called the \textit{divisor class group} or the Picard group of $E$ and is denoted by $\mr{Pic}^0(E)$. For elliptic curves,  $\mr{Pic}^0(E)$ has a canonical isomorphism with $E$. For higher genus curves, $\mr{Pic}^0(C)$ is not in bijection with $C$ but has the structure of an \textit{abelian variety}, a protective variety with a group structure.  


For a function $f\in \bFq(E)$ and a divisor $D= \slim_{P} m_{f,P}P$ such that $D$, $(f)$ have disjoint supports, we have \vs $$f(D) = \pl_{P} f(P)^{m_{f,P}} .$$ The \textit{Weil reciprocity law} states that for non-zero functions $f$, $g$ on the curve with disjoint supports, \vs $$f((g)) = g((f)) .$$ We omit the details since that would be too great a digression but we note that this lies at the heart of many of the proofs of the pairing properties of elliptic curves.\\

For distinct points $P$, $Q$ on the curve, we denote the line passing through them by $\mc{L}_{P,Q}$ (or $\mc{L}_{Q, P}$). We denote the tangent line to the curve at the point $P$ by $\mc{L}_{P, P}$. We denote the vertical line passing through $P$ (and $-P$) by $\mc{V}_P$ (or $\mc{V}_{-P}$). \\



\noin \textbf{Pairings:} Let $E$ be an elliptic curve over a finite field $\bFq$  of characteristic $p$. Let $\pi$ be the Weil number associated to $E$. Then $\pi$ is an algebraic integer such that $\pi\cdot \ov{\pi} = q$ and $\pi+\ov{\pi}\in \bz$. Furthermore, the number of $\bFqk$-points on $E$ is given by $|(1-\pi^k)(1-\ov{\pi}^k)|$.


Now, suppose $\ell\neq p$ is a prime such that $\# E(\bFq)\in \ell\bz\setminus \ell^2\bz$. Then the $\ell$-torsion group $E(\bFP)[\ell]$ is isomorphic to $\bz/\ell\bz \times \bz/\ell\bz$ while $E(\bFq)[\ell]\cong \bz/\ell\bz$. Let $k$ be the embedding degree of $E$ with respect to $\ell$. We denote by $\mu_{\ell}(\bF _{q^k})$ the unique cyclic subgroup of $\bF _{q^k}^*$ of order $\ell$.\\

\noin \textbf{The Tate pairing:} Let $P\in E(\bFq)[\ell]$. Then there exists a rational function $f_{\ell,P}$ with divisor $(f_{\ell,P}) = \ell(P) - \ell(\infty_{_E})$. Let $Q\in E(\bFq)$ be any representative in the equivalence class\\ $E(\bF _ {q^k})/\ell \cdot E(\bF _ {q^k})$. Let $D_Q$ be a degree zero divisor defined over $\bF _ {q^k}$ that is equivalent to $(Q)-(\infty_{_E})$ but whose support is disjoint from that of $(f_{\ell,P})$. The (intermediate) Tate pairing $t_{\ell}$ is a map \vs $$t_{\ell}: E(\bF _ {q^k})[\ell]\times E(\bF _ {q^k})/\ell \cdot E(\bF _ {q^k})\;\lra\; \bF _ {q^k}^*/(\bF _ {q^k}^*)^{\ell}\;\;,\;\;(P,Q)\mapsto f_{\ell,P}(D_Q) \vs .$$ This pairing is bilinear and non-degenerate and the target group is the quotient group $\bF _ {q^k}^*/(\bF _ {q^k}^*)^{\ell}$ which is cyclic of order $\ell$. 

A shortcoming of this pairing is that it is not entirely deterministic. Different parties may compute values that coincide under this notion of equivalence   but are distinct in a stricter sense. To this end, we modify the definition by defining \vs $$T_{\ell} : E(\bF _ {q^k})[\ell]\times E(\bF _ {q^k})/\ell \cdot E(\bF _ {q^k})\;\;\lra\;\; \mu_{\ell}(\bF _ {q^k})\vs $$ \vs $$(P,Q)\;\;\mapsto\;\; t_{\ell}(P,Q)^{(q^k-1)/\ell} = f_{\ell, P}(D_Q)^{(q^k-1)/\ell}. $$  

\noin The last part is a (rather expensive) exponentiation in the finite field $\bF _ {q^k}$ and is called the \textit{final exponentiation} for Tate pairings. It is one of the two components of a Tate pairing, the other being the Miller loops which we describe below. 



    
\bigskip



\noin \textbf{The Weil pairing:} Let $P, Q \in E(\bFqk)[\ell]$ and let $D_P$, $D_Q$ be divisors with disjoint supports such that $D_P \sim (P) - (\infty_{_E}) $, $D_Q \sim (Q) - (\infty_{_E}) $. There exist rational functions $f_{\ell,P}$, $g_{\ell,P}$ such that $(f_{\ell,P}) = \ell \cdot D_P$, $(g_{\ell,P}) = \ell \cdot D_Q$. The Weil pairing is a map \vs $$w_{\ell}: E(\bFqk)[\ell]\times E(\bFqk)[\ell]\;\lra \; \mu_{\ell}(\bFqk) $$ defined by \vs $$w_{\ell}(P,Q):= \frac{f_{\ell,P}(D_Q)}{g_{\ell,Q}(D_P)}. $$ This map is well-defined, i.e. the value $w_{\ell}(P,Q)$ is independent of the choice of the rational functions $f_{\ell,P}$, $g_{\ell,P}$. The Weil pairing is bilinear, non-degenerate and \textit{alternating} in the sense that $w_{\ell}(P,P) = 1$ for any point $P$. Furthermore, $w_{\ell}(P,Q) = 1$ if and only if $P$ and $Q$ lie in the same cyclic group of order $\ell$. Thus, choosing $r$-torsion points $P$, $Q$ that generate distinct cyclic groups $\mb{G}_1$, $\mb{G}_2$ of order $\ell$ and setting $\mb{G}_T:= \mu_{\ell}(\bFqk)$ yields a non-degenerate bilinear pairing \vs $$\e: \mb{G}_1\times\mb{G}_2 \;\lra\; \mb{G}_T . $$    

Although the Tate and Weil pairings are significantly different, their computations have a common structure. The Weil pairing boils down to computing $f_{\ell,P}(D_Q)$, $g_{\ell,P}(D_P)$ $\in \bFqk^*$. The Tate pairing entails computing $f_{\ell,P}(D_Q)\in \bFqk^*$ followed by the final exponentiation.\\


\noin \textbf{The security parameter:} The integer $\frac{\ell-1}{k}$ is called the security parameter of $E$ with respect to $\ell$. The strongest attacks against the discrete logarithm problem in the $\ell$-torsion subgroup of $E$ are 

\noin - the MOV (Menezes Okamoto Vanstone) attack which has runtime complexity $\mbf{O}\big(\frac{\ell-1}{k}).$ \\
- the Kim-Barbelescu number field sieve attack that exploits the discrete log in the target group $\bG_T$.

Thus, the integer $\frac{\ell-1}{k}$ has to be large enough for the scheme to be secure. Furthermore, $k$ has to be sufficiently large so that the index calculus attack against the DLP in $\bFqk^*$ is infeasible. On the other hand, the integer $q^k$ has to be small enough for the arithmetic in the field $\bF _{q^k}$ to be reasonably efficient. It appears that the golden mean  lies at ordinary elliptic curves with embedding degree $12$. For $128$-bit security, we need the elliptic curve to be defined over a $380$-bit prime and for the prime $\ell$ to be a $256$-bit prime.  

The curve $E$ is said to be \textit{pairing-friendly} if $\# E(\bFq)$ has a prime divisor $\ell$ such that:

\noin - $\ell\geq \sqrt{q}$\\
- the embedding degree of $E$ with respect to $\ell$ is  $\leq \log_2(\ell)/8$

In practice, the curve most widely used for SNARKs is the BLS12-381, thus named because it is defined over a $381$-bit prime field $\bFp$ and $\# E(\bFp)$ has a $256$-bit prime divisor $\ell$ such that $E$ has embedding degree $12$ with respect to $\ell$.

The BLS12-381 curve is given by the equation \vs $$E: y^2 = x^3+4 \vs $$ over a certain prime field $\bFp$ of bit-size $381$. The group $E(\bFp)$ is cyclic of order $\ell$ for a $255$-bit prime $\ell$ such that the embedding degree of $E$ with respect to $\ell$ is $12$.    The curve $E$ is ordinary and has endomorphism algebra $\bq(\sqrt{-3})$.\\


\noin \textbf{Miller's algorithm:} We now describe Miller's algorithm which allows us to compute pairings \textit{efficiently}. This elegant algorithm is the reason pairings are of practical value rather than purely of theoretical interest. A naive approach would mean $\bO(\ell)$ operations in the elliptic curve over a finite field $\bFp$, which would be impractical when $\ell \approx 2^{256}$ and $p\approx 2^{381}$. Miller's algorithm allows us to compute the parings with $\bO(\log(\ell))$  elliptic curve scalar multiplications and a final exponentiation in $\bFqk^*$.

In practice, the best optimized Tate pairing is substantially faster than the best optimized Weil pairing. Hence, we typically use Tate pairings when the     effective runtime is crucial, as is the case with blockchains.

As before, let $P$ be a point on the elliptic curve $E$. The key ingredient is to determine a function $f_{P}$ with divisor $\ell(P)-\ell(\infty_{_E})$. For every integer $i\geq 1$, the $f_{i,P}$ be a function whose divisor is \vs $$\divv(f_i) = i(P)	- ([i]P) - (i-1)(\infty_{_E}). $$ In particular, $f_{1,P} = 1$ and $f_{\ell,P} = f_{P}$. The following relation enables efficient computation of $f_{\ell,P}(D_Q)$


\begin{Lem} Let $P\in E[\ell]$ and let $i$, $j$ be integers $\geq 1$. Let $\mc{L}_{[i]P, [j]P}$ be the line through $[i]P$ and $[j]P$. Let $\mc{V}_{[i+j]P}$ be the vertical line through $[i+j]P$. Then $f_{i+j,P} = f_{i,P}f_{j,P}\frac{\mc{L}_{[i]P, [j]P}}{\mc{V}_{[i+j]P}}$.\end{Lem}


It is important to note that the degree of $f_{n,P}$ grows linearly with $n$ (en route to $\ell$). Hence, the degree of the rational function $f_{n,P}\in \bFqk(E)$ eventually becomes too large for $f_{n,P}\in \bFqk(E)$ to be stored. Miller's algorithm circumvents this bottleneck by storing the evaluation $f_{n,P}(D_Q)$ at the divisor $D_Q$ instead of storing $f_{n,P}$. 



\bigskip

\begin{mdframed} \textbf{Miller's algorithm to compute  the Tate pairing $T_{\ell}(P,Q)$} \vspace{0.15cm}

\noin \textbf{Input:} $P\in E(\bFqk)[\ell]$;\hspace{1mm} $Q  =\wti{Q}+ \ell \cdot E(\bF _ {q^k})\in E(\bF _ {q^k})/\ell \cdot E(\bF _ {q^k}) $; 

\noin $D_{Q}\sim (Q)-(\infty_{_E})$ with support disjoint from $(f_{\ell,P})$; 

\noin the binary representation $\ell = (r_{n-1}\cdots r_1 r_0)_2$ with $r_{n-1} = 1$ \vspace{0.15cm}

\noin \textbf{Output:} $f_{\ell,P}(D_Q)\gets f$ \vspace{0.15cm}

\begin{enumerate}[wide, labelwidth=!, labelindent=0pt]\vs \item $R\gets P$, $f\gets 1$

\item \textbf{for} $i = n-2$ down to $0$ do:

\item Compute the line functions $\mc{L}_{R,R}$ and $\mc{V}_{[2]R}$ for doubling $R$.

\item $R\gets [2]R$

\item $f\gets f^2\cdot \frac{\mc{L}_{R,R}}{\mc{V}_{[2]R}}(D_Q)$

\item \textbf{if} $r_i =1$ then 

\item Compute the line functions $\mc{L}_{R,P}$ and $\mc{V}_{R+P}$ for adding $R$ and $P$

\item $R\gets R+P$

\item $f\gets f\cdot \frac{\mc{L}_{R,P}}{\mc{V}_{R+P}}(D_Q)$

\item end \textbf{if}

\item end \textbf{for}

\item return $f^{(q^k-1)/{\ell}}$ \qed \end{enumerate} \end{mdframed}

\bigskip

Miller's algorithm to compute the Weil pairing has a similar structure. We can simulate Steps 1-11 to compute $f_{\ell,P}(D_Q)$, $g_{\ell,Q}(D_P))$ and then compute $\frac{f_{\ell,P}(D_Q)}{g_{\ell,Q}(D_P)} \in \mule(\bFqk^*).$






\subsection{\fontsize{11}{11}\selectfont Summary}

There is consensus that type III pairings are faster than type I and type II pairings and that Tate pairings are faster than Weil pairings. Hence, it is optimal to use a Tate pairing for an ordinary pairing-friendly elliptic curve. The curve most suitable for this purpose seems to be the BLS12-381 curve.

The fundamental computation in elliptic curve cryptography is the scalar multiplication $m\cdot P$ for an integer $m$ and an elliptic curve point $P$. This point is computed in runtime $\bO(\log(m))$ via a sequence of point doublings and point additions. One of the components of a Tate pairing is the Miller loop, which is largely an extension of the scalar multiplication computation. The other key component in a Tate pairing is the final exponentiation which is a rather expensive exponentiation operation in a finite field of size $q^k$, where $k$ is the embedding degree.  

In pairing-based SNARKs such as PLONK, Groth16 etc, the Verifier's work is dominated by pairing computations. Thus, optimizing pairings is crucial for applications of SNARKs to blockchains.











\subsection{\fontsize{11}{11}\selectfont Symbols}

\noin $(f)$: divisor of a rational function $f\in \bFP(E)$ \vspace{2mm}

\noin $\infty_{_E}$: The $E$-point at infinity \vspace{2mm}

\noin $D_P$: the divisor $(P)-(\infty_{_E})$ \vspace{2mm}

\noin $E(K)$: the group of $K$-valued points of $E$ \vspace{2mm}

\noin $E[n]$: the $n$-torsion subgroup of $E$ \vspace{2mm}

\noin $\mc{L}_{P,Q}: \begin{cases} \text{the line passing through } P \text{ and } Q \text{ if } P\neq Q\\ \text{the tangent line at } P \text{ if } P = Q \end{cases}$\vspace{2mm}

\noin $\mc{V}_{P}$: the vertical line passing through $P$ (and $-P$) \vspace{2mm}

\noin $T_{\ell}(P,Q)$: the order $\ell$ reduced Tate pairing \vspace{2mm}

\noin $t_{\ell}(P,Q)$: the intermediate order $\ell$ Tate pairing \vspace{2mm}

\noin $w_{\ell}(P,Q)$: the order $\ell$ Weil pairing  \vspace{2mm}

\noin BLS: Boneh-Lynn-Scott \vspace{2mm}

\noin $\mr{Div}(E)$: group of divisors on $E$ \vspace{2mm}

\noin $\mr{Div}_F(E)$: group of divisors on $E$ defined over $F$ \vspace{2mm}

\noin $\mr{Div}^0(E)$: group of degree zero dvisors on $E$ \vspace{2mm}

\noin $\mr{Div}^0_F(E)$: group of degree zero divisors on $E$ defined over $F$ \vspace{2mm}

\noin $\mr{ord}_P(f)$: the multiplicity of $f$ at $P$ on $E$ \vspace{2mm}

\noin $\End(E)$: The endomorphism ring of $E$  \vspace{2mm}

\noin $\End^0(E)$: The endomorphism algebra of $E$ \vspace{2mm}

\noin $\absf$: The absolute Galois group of $F$ \vspace{2mm}

\noin $\mu_{\ell}(\bFqk)$: The $\ell$-torsion of $\bFqk^*$ \vspace{2mm}

\noin $f_{n,P}$: A function with divisor $n(P)-([n]P)- (n-1)(\infty_{_E})$ \hspace{2mm} ($n\in \bz$, $P\in E(\bFqk)$) \vspace{2mm}

\noin $\mr{supp}(f)$: the support of a function $f$ \vspace{2mm}

\noin $\Phi_k(X):$ The $k$-th cyclotomic polynomial





























\end{document}