## -*- encoding: utf-8 -*-

# This file was *autogenerated* from the file /home/mirco/Leastauthority/MMM/moonmath-manual/main-moonmath.sagetex.sage
from sage.all_cmdline import *   # import sage library

_sage_const_182 = Integer(182); _sage_const_1428 = Integer(1428); _sage_const_852 = Integer(852); _sage_const_907 = Integer(907); _sage_const_1521 = Integer(1521); _sage_const_913 = Integer(913); _sage_const_695 = Integer(695); _sage_const_918 = Integer(918); _sage_const_1753 = Integer(1753); _sage_const_290 = Integer(290); _sage_const_85 = Integer(85); _sage_const_87 = Integer(87); _sage_const_294 = Integer(294); _sage_const_81 = Integer(81); _sage_const_296 = Integer(296); _sage_const_297 = Integer(297); _sage_const_768 = Integer(768); _sage_const_1170 = Integer(1170); _sage_const_9973 = Integer(9973); _sage_const_1037 = Integer(1037); _sage_const_1480 = Integer(1480); _sage_const_1024 = Integer(1024); _sage_const_535 = Integer(535); _sage_const_1022 = Integer(1022); _sage_const_537 = Integer(537); _sage_const_13 = Integer(13); _sage_const_12 = Integer(12); _sage_const_11 = Integer(11); _sage_const_10 = Integer(10); _sage_const_17 = Integer(17); _sage_const_16 = Integer(16); _sage_const_15 = Integer(15); _sage_const_14 = Integer(14); _sage_const_19 = Integer(19); _sage_const_18 = Integer(18); _sage_const_1724 = Integer(1724); _sage_const_1691 = Integer(1691); _sage_const_101 = Integer(101); _sage_const_105 = Integer(105); _sage_const_107 = Integer(107); _sage_const_583 = Integer(583); _sage_const_588 = Integer(588); _sage_const_995 = Integer(995); _sage_const_737 = Integer(737); _sage_const_1780 = Integer(1780); _sage_const_323 = Integer(323); _sage_const_732 = Integer(732); _sage_const_326 = Integer(326); _sage_const_1675 = Integer(1675); _sage_const_1650 = Integer(1650); _sage_const_882 = Integer(882); _sage_const_1808 = Integer(1808); _sage_const_138 = Integer(138); _sage_const_68 = Integer(68); _sage_const_988 = Integer(988); _sage_const_550 = Integer(550); _sage_const_1791 = Integer(1791); _sage_const_721 = Integer(721); _sage_const_1416 = Integer(1416); _sage_const_899 = Integer(899); _sage_const_925 = Integer(925); _sage_const_1557 = Integer(1557); _sage_const_1007 = Integer(1007); _sage_const_1719 = Integer(1719); _sage_const_1550 = Integer(1550); _sage_const_1089 = Integer(1089); _sage_const_807 = Integer(807); _sage_const_45 = Integer(45); _sage_const_77 = Integer(77); _sage_const_419 = Integer(419); _sage_const_128 = Integer(128); _sage_const_1091 = Integer(1091); _sage_const_1458 = Integer(1458); _sage_const_1495 = Integer(1495); _sage_const_1491 = Integer(1491); _sage_const_268 = Integer(268); _sage_const_715 = Integer(715); _sage_const_717 = Integer(717); _sage_const_80 = Integer(80); _sage_const_1175 = Integer(1175); _sage_const_815 = Integer(815); _sage_const_30 = Integer(30); _sage_const_956 = Integer(956); _sage_const_793 = Integer(793); _sage_const_40 = Integer(40); _sage_const_41 = Integer(41); _sage_const_42 = Integer(42); _sage_const_43 = Integer(43); _sage_const_44 = Integer(44); _sage_const_390 = Integer(390); _sage_const_46 = Integer(46); _sage_const_392 = Integer(392); _sage_const_48 = Integer(48); _sage_const_49 = Integer(49); _sage_const_1749 = Integer(1749); _sage_const_1082 = Integer(1082); _sage_const_157 = Integer(157); _sage_const_154 = Integer(154); _sage_const_1454 = Integer(1454); _sage_const_314 = Integer(314); _sage_const_276 = Integer(276); _sage_const_465 = Integer(465); _sage_const_272 = Integer(272); _sage_const_1104 = Integer(1104); _sage_const_1504 = Integer(1504); _sage_const_469 = Integer(469); _sage_const_1665 = Integer(1665); _sage_const_787 = Integer(787); _sage_const_1099 = Integer(1099); _sage_const_1661 = Integer(1661); _sage_const_58 = Integer(58); _sage_const_57 = Integer(57); _sage_const_56 = Integer(56); _sage_const_55 = Integer(55); _sage_const_54 = Integer(54); _sage_const_53 = Integer(53); _sage_const_52 = Integer(52); _sage_const_51 = Integer(51); _sage_const_50 = Integer(50); _sage_const_659 = Integer(659); _sage_const_410 = Integer(410); _sage_const_140 = Integer(140); _sage_const_143 = Integer(143); _sage_const_652 = Integer(652); _sage_const_301 = Integer(301); _sage_const_3 = Integer(3); _sage_const_2 = Integer(2); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0); _sage_const_7 = Integer(7); _sage_const_6 = Integer(6); _sage_const_5 = Integer(5); _sage_const_4 = Integer(4); _sage_const_1812 = Integer(1812); _sage_const_9 = Integer(9); _sage_const_8 = Integer(8); _sage_const_1113 = Integer(1113); _sage_const_1111 = Integer(1111); _sage_const_28 = Integer(28); _sage_const_29 = Integer(29); _sage_const_877 = Integer(877); _sage_const_22 = Integer(22); _sage_const_23 = Integer(23); _sage_const_20 = Integer(20); _sage_const_21 = Integer(21); _sage_const_26 = Integer(26); _sage_const_27 = Integer(27); _sage_const_24 = Integer(24); _sage_const_25 = Integer(25); _sage_const_665 = Integer(665); _sage_const_1696 = Integer(1696); _sage_const_1894 = Integer(1894); _sage_const_668 = Integer(668); _sage_const_213 = Integer(213); _sage_const_215 = Integer(215); _sage_const_845 = Integer(845); _sage_const_1516 = Integer(1516); _sage_const_39 = Integer(39); _sage_const_38 = Integer(38); _sage_const_964 = Integer(964); _sage_const_1121 = Integer(1121); _sage_const_31 = Integer(31); _sage_const_686 = Integer(686); _sage_const_33 = Integer(33); _sage_const_32 = Integer(32); _sage_const_35 = Integer(35); _sage_const_34 = Integer(34); _sage_const_37 = Integer(37); _sage_const_36 = Integer(36); _sage_const_168 = Integer(168); _sage_const_282 = Integer(282); _sage_const_287 = Integer(287); _sage_const_902 = Integer(902); _sage_const_1884 = Integer(1884); _sage_const_47 = Integer(47); _sage_const_562 = Integer(562); _sage_const_774 = Integer(774)## This file (main-moonmath.sagetex.sage) was *autogenerated* from main-moonmath.tex with sagetex.sty version 2019/01/09 v3.2.
import sagetex
_st_ = sagetex.SageTeXProcessor('main-moonmath', version='2019/01/09 v3.2', version_check=True)
try:
 _st_.current_tex_line = _sage_const_48 
 _st_.commandline(_sage_const_0 , r"""
sage: ZZ # A sage notation for the integer type
sage: NN # A sage notation for the counting number type
sage: ZZ(5) # Get an element from the Ring of integers
sage: ZZ(5) + ZZ(3)
sage: ZZ(5) * NN(3)
sage: ZZ.random_element(10**50)
sage: ZZ(27713).str(2) # Binary string representation
sage: NN(27713).str(2) # Binary string representation
sage: ZZ(27713).str(16) # Hexadecimal string representation
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_58 )
try:
 _st_.current_tex_line = _sage_const_77 
 _st_.commandline(_sage_const_1 , r"""
sage: n = NN(19214758032624000)
sage: factor(n)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_80 )
try:
 _st_.current_tex_line = _sage_const_138 
 _st_.commandline(_sage_const_2 , r"""
sage: ZZ(-17) // ZZ(4) # Integer quotient
sage: ZZ(-17) % ZZ(4) # remainder
sage: ZZ(4).divides(ZZ(-17)) # self divides other
sage: ZZ(4).divides(ZZ(12))
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_143 )
try:
 _st_.current_tex_line = _sage_const_154 
 _st_.commandline(_sage_const_3 , r"""
sage: ZZ(143785).quo_rem(ZZ(17)) # Euclidean Division
sage: ZZ(143785) == ZZ(8457)*ZZ(17) + ZZ(16) # check
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_157 )
try:
 _st_.current_tex_line = _sage_const_213 
 _st_.commandline(_sage_const_4 , r"""
sage: ZZ(12).xgcd(ZZ(5)) # (gcd(a,b),s,t)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_215 )
try:
 _st_.current_tex_line = _sage_const_287 
 _st_.commandline(_sage_const_5 , r"""
sage: ZZ(137).gcd(ZZ(64))
sage: ZZ(64)** ZZ(137) % ZZ(137) == ZZ(64) % ZZ(137)
sage: ZZ(64)** ZZ(137-1) % ZZ(137) == ZZ(1) % ZZ(137)
sage: ZZ(1918).gcd(ZZ(137))
sage: ZZ(1918)** ZZ(137) % ZZ(137) == ZZ(1918) % ZZ(137)
sage: ZZ(1918)** ZZ(137-1) % ZZ(137) == ZZ(1) % ZZ(137)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_294 )
try:
 _st_.current_tex_line = _sage_const_323 
 _st_.commandline(_sage_const_6 , r"""
sage: (ZZ(7)* (ZZ(2)*ZZ(4) + ZZ(21)) + ZZ(11))  % ZZ(6) == (ZZ(4) - ZZ(102))  % ZZ(6)
sage: (ZZ(7)* (ZZ(2)*ZZ(76) + ZZ(21)) + ZZ(11))  % ZZ(6) == (ZZ(76) - ZZ(102))  % ZZ(6)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_326 )
try:
 _st_.current_tex_line = _sage_const_390 
 _st_.commandline(_sage_const_7 , r"""
sage: CRT_list([4,1,3,0], [7,3,5,11])
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_392 )
try:
 _st_.current_tex_line = _sage_const_465 
 _st_.commandline(_sage_const_8 , r"""
sage: Z6 = Integers(6)
sage: Z6(2) + Z6(5)
sage: Z6(7)*(Z6(2)*Z6(4)+Z6(21))+Z6(11) == Z6(4) - Z6(102)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_469 )
try:
 _st_.current_tex_line = _sage_const_535 
 _st_.commandline(_sage_const_9 , r"""
sage: ZZ(6).xgcd(ZZ(5))
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_537 )
try:
 _st_.current_tex_line = _sage_const_583 
 _st_.commandline(_sage_const_10 , r"""
sage: Z5 = Integers(5)
sage: Z5(3)**(5-2)
sage: Z5(3)**(-1)
sage: Z5(3)**(5-2) == Z5(3)**(-1)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_588 )
try:
 _st_.current_tex_line = _sage_const_652 
 _st_.commandline(_sage_const_11 , r"""
sage: Zx = ZZ['x'] # integer polynomials with indeterminate x
sage: Zt.<t> = ZZ[] # integer polynomials with indeterminate t
sage: Zx
sage: Zt
sage: p1 = Zx([17,-4,2])
sage: p1
sage: p1.degree()
sage: p1.leading_coefficient()
sage: p2 = Zt(t^23)
sage: p2
sage: p6 = Zx([0])
sage: p6.degree()
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_665 )
try:
 _st_.current_tex_line = _sage_const_686 
 _st_.commandline(_sage_const_12 , r"""
sage: Z6 = Integers(6)
sage: Z6x = Z6['x']
sage: Z6x
sage: p1 = Z6x([5,-4,2])
sage: p1
sage: p1 = Z6x([17,-4,2])
sage: p1
sage: Z6x(x-2)*Z6x(x+3)*Z6x(x-5) == Z6x(x^3 + 2*x^2 + x)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_695 )
try:
 _st_.current_tex_line = _sage_const_715 
 _st_.commandline(_sage_const_13 , r"""
sage: Zx = ZZ['x']
sage: p1 = Zx([17,-4,2])
sage: p7 = Zx(x-2)*Zx(x+3)*Zx(x-5)
sage: p1(ZZ(2))
sage: p7(ZZ(-6)) == ZZ(-264)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_721 )
try:
 _st_.current_tex_line = _sage_const_732 
 _st_.commandline(_sage_const_14 , r"""
sage: Z6 = Integers(6)
sage: Z6x = Z6['x']
sage: p1 = Z6x([5,-4,2])
sage: p1(Z6(2)) == Z6(5)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_737 )
try:
 _st_.current_tex_line = _sage_const_768 
 _st_.commandline(_sage_const_15 , r"""
sage: Zx = ZZ['x']
sage: P = Zx([2,-4,5])
sage: Q = Zx([5,0,-2,1])
sage: P+Q == Zx(x^3 +3*x^2 -4*x +7)
sage: P*Q == Zx(5*x^5 -14*x^4 +10*x^3+21*x^2-20*x +10)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_774 )
try:
 _st_.current_tex_line = _sage_const_787 
 _st_.commandline(_sage_const_16 , r"""
sage: Z6x = Integers(6)['x']
sage: P = Z6x([2,-4,5])
sage: Q = Z6x([5,0,-2,1])
sage: P+Q == Z6x(x^3 +3*x^2 +2*x +1)
sage: P*Q == Z6x(5*x^5 +4*x^4 +4*x^3+3*x^2+4*x +4)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_793 )
try:
 _st_.current_tex_line = _sage_const_845 
 _st_.commandline(_sage_const_17 , r"""
sage: Zx = ZZ['x']
sage: A = Zx([-9,0,0,2,0,1])
sage: B = Zx([-1,4,1])
sage: M = Zx([-80,19,-4,1])
sage: R = Zx([-89,339])
sage: A == M*B + R
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_852 )
try:
 _st_.current_tex_line = _sage_const_877 
 _st_.commandline(_sage_const_18 , r"""
sage: Zx = ZZ['x']
sage: p = Zx(x^2-3)
sage: p.roots()
sage: p.factor()
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_882 )
try:
 _st_.current_tex_line = _sage_const_902 
 _st_.commandline(_sage_const_19 , r"""
sage: Zx = ZZ['x']
sage: p = Zx(x^7 + 3*x^6 + 3*x^5 + x^4 - x^3 - 3*x^2 - 3*x - 1)
sage: p.roots()
sage: p.factor()
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_907 )
try:
 _st_.current_tex_line = _sage_const_272 
 _st_.commandline(_sage_const_20 , r"""
sage: QQ
sage: QQ(1/5) # Get an element from the field of rational numbers
sage: QQ(1/5) / QQ(3) # Division
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_276 )
try:
 _st_.current_tex_line = _sage_const_296 
 _st_.commandline(_sage_const_21 , r"""
sage: F2 = GF(2)
sage: F2(1) # Get an element from GF(2)
sage: F2(1) + F2(1) # Addition
sage: F2(1) / F2(1) # Division
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_301 )
try:
 _st_.current_tex_line = _sage_const_550 
 _st_.commandline(_sage_const_22 , r"""
sage: Z3 = GF(3) # prime field
sage: Z3t.<t> = Z3[] # polynomials over Z3
sage: P = Z3t(t^2+1)
sage: P.is_irreducible()
sage: F3_2.<t> = GF(3^2, name='t', modulus=P)
sage: F3_2
sage: F3_2(t+2)*F3_2(2*t+2) == F3_2(2)
sage: F3_2(2*t+2)^(-1) # multiplicative inverse
sage: # verify our solution to (t+1)(x^2 + (2t+2)) = 2
sage: F3_2(t+1)*(F3_2(t)**2 + F3_2(2*t+2)) == F3_2(2)
sage: F3_2(t+1)*(F3_2(2*t)**2 + F3_2(2*t+2)) == F3_2(2)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_562 )
_st_.current_tex_line = _sage_const_35 
_st_.blockbegin()
try:
 E1 = EllipticCurve([-_sage_const_2 ,_sage_const_1 ])
 C1 = E1.plot()
 F = GF(_sage_const_9973 )
 E2 = EllipticCurve(F, [-_sage_const_2 ,_sage_const_1 ])
 C2 = E2.plot()
except:
 _st_.goboom(_sage_const_41 )
_st_.blockend()
try:
 _st_.current_tex_line = _sage_const_43 
 _st_.plot(_sage_const_0 , format='notprovided', _p_=C1)
except:
 _st_.goboom(_sage_const_43 )
try:
 _st_.current_tex_line = _sage_const_44 
 _st_.plot(_sage_const_1 , format='notprovided', _p_=C2)
except:
 _st_.goboom(_sage_const_44 )
try:
 _st_.current_tex_line = _sage_const_52 
 _st_.commandline(_sage_const_23 , r"""
sage: F5 = GF(5) # define the base field
sage: a = F5(2) # parameter a
sage: b = F5(4) # parameter b
sage: # check non-sigularity
sage: F5(6)*(F5(4)*a^3+F5(27)*b^2) != F5(0)
sage: # short Weierstrass curve
sage: E = EllipticCurve(F5,[a,b]) # y^2 == x^3 + ax +b
sage: P = E(0,2) # 2^2 == 0^3 + 2*0 + 4
sage: P.xy() # affine coordinates
sage: INF = E(0) # point at infinity
sage: try:  # point at infinity has no affine coordinates
....:     INF.xy()
....: except ZeroDivisionError:
....:     pass
sage: P = E.plot() # create a plotted version
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_68 )
_st_.current_tex_line = _sage_const_81 
_st_.blockbegin()
try:
 F5 = GF(_sage_const_5 )
 E1 = EllipticCurve(F5, [_sage_const_1 ,_sage_const_1 ])
 C1 = E1.plot()
except:
 _st_.goboom(_sage_const_85 )
_st_.blockend()
try:
 _st_.current_tex_line = _sage_const_87 
 _st_.plot(_sage_const_2 , format='notprovided', _p_=C1)
except:
 _st_.goboom(_sage_const_87 )
_st_.current_tex_line = _sage_const_101 
_st_.blockbegin()
try:
 F13 = GF(_sage_const_13 )
 PJJ_13 = EllipticCurve(F13, [_sage_const_8 ,_sage_const_8 ])
 CPJJ_13 = PJJ_13.plot()
except:
 _st_.goboom(_sage_const_105 )
_st_.blockend()
try:
 _st_.current_tex_line = _sage_const_107 
 _st_.plot(_sage_const_3 , format='notprovided', _p_=CPJJ_13)
except:
 _st_.goboom(_sage_const_107 )
try:
 _st_.current_tex_line = _sage_const_128 
 _st_.commandline(_sage_const_24 , r"""
sage: p = 115792089237316195423570985008687907853269984665640564039457584007908834671663
sage: # Hexadecimal representation
sage: p.str(16)
sage: p.is_prime()
sage: p.nbits()
sage: Fp = GF(p)
sage: Secp256k1 = EllipticCurve(Fp,[0,7])
sage: r = Secp256k1.order() # number of elements
sage: r.str(16)
sage: r.is_prime()
sage: r.nbits()
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_140 )
try:
 _st_.current_tex_line = _sage_const_168 
 _st_.commandline(_sage_const_25 , r"""
sage: P = Secp256k1.random_point().xy()
sage: P
sage: # uncompressed affine point size
sage: ZZ(P[0]).nbits()+ZZ(P[1]).nbits()
sage: # compute the compression
sage: if P[1] > Fp(-1)/Fp(2):
....:     PARITY = 1
....: else:
....:     PARITY = 0
sage: PCOMPRESSED = [P[0],PARITY]
sage: PCOMPRESSED
sage: # compressed affine point size
sage: ZZ(PCOMPRESSED[0]).nbits()+ZZ(PCOMPRESSED[1]).nbits()
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_182 )
try:
 _st_.current_tex_line = _sage_const_268 
 _st_.commandline(_sage_const_26 , r"""
sage: F5 = GF(5)
sage: E1 = EllipticCurve(F5,[1,1])
sage: INF = E1(0) # point at infinity
sage: P1 = E1(0,1)
sage: P2 = E1(4,2)
sage: P3 = E1(0,4)
sage: R1 = E1(2,1)
sage: R2 = E1(3,4)
sage: R1 == P1+P2
sage: INF == P1+P3
sage: R2 == P2+P2
sage: R2 == 2*P2
sage: P3 == P3 + INF
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_282 )
try:
 _st_.current_tex_line = _sage_const_290 
 _st_.commandline(_sage_const_27 , r"""
sage: F13 = GF(13)
sage: MJJ = EllipticCurve(F13,[8,8])
sage: P = MJJ(4,0)
sage: INF = MJJ(0) # Point at infinity
sage: INF == P+P
sage: INF == 2*P
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_297 )
try:
 _st_.current_tex_line = _sage_const_301 
 _st_.commandline(_sage_const_28 , r"""
sage: P = Secp256k1.random_point()
sage: Q = Secp256k1.random_point()
sage: INF = Secp256k1(0)
sage: R1 = -P
sage: R2 = P + Q
sage: R3 = Secp256k1.order()*P
sage: P.xy()
sage: Q.xy()
sage: (ZZ(R1[0]).str(16), ZZ(R1[1]).str(16))
sage: R2.xy()
sage: R3 == INF
sage: P[1]+R1[1] == Fp(0) # -(x,y) = (x,-y)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_314 )
try:
 _st_.current_tex_line = _sage_const_410 
 _st_.commandline(_sage_const_29 , r"""
sage: F13 = GF(13)
sage: PJJ = EllipticCurve(F13,[8,8])
sage: P = PJJ(5,11)
sage: INF = PJJ(0)
sage: 10*P == INF
sage: Q = PJJ(9,4)
sage: R = PJJ(4,0)
sage: 10*Q == R
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_419 )
try:
 _st_.current_tex_line = _sage_const_659 
 _st_.commandline(_sage_const_30 , r"""
sage: F13 = GF(13)
sage: L_MPJJ = []
....: for x in F13:
....:     for y in F13:
....:         if F13(7)*y^2 == x^3 + F13(6)*x^2 +x:
....:             L_MPJJ.append((x,y))
sage: MPJJ = Set(L_MPJJ)
sage: # does not compute the point at infinity
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_668 )
try:
 _st_.current_tex_line = _sage_const_695 
 _st_.commandline(_sage_const_31 , r"""
sage: # Compute PHI of Montgomery form:
sage: L_PHI_MPJJ = []
sage: for (x,y) in L_MPJJ: # LMJJ as defined previously
....:     v = (F13(3)*x + F13(6))/(F13(3)*F13(7))
....:     w = y/F13(7)
....:     L_PHI_MPJJ.append((v,w))
sage: PHI_MPJJ = Set(L_PHI_MPJJ)
sage: # Computation Weierstrass form
sage: C_WPJJ = EllipticCurve(F13,[8,8])
sage: L_WPJJ = [P.xy() for P in C_WPJJ.points() if P.order() > 1]
sage: WPJJ = Set(L_WPJJ)
sage: # check PHI(Montgomery) == Weierstrass
sage: WPJJ == PHI_MPJJ
sage: # check the inverse map PHI^(-1)
sage: L_PHIINV_WPJJ = []
sage: for (v,w) in L_WPJJ:
....:     x = F13(7)*(v-F13(4))
....:     y = F13(7)*w
....:     L_PHIINV_WPJJ.append((x,y))
sage: PHIINV_WPJJ = Set(L_PHIINV_WPJJ)
sage: MPJJ == PHIINV_WPJJ
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_717 )
try:
 _st_.current_tex_line = _sage_const_807 
 _st_.commandline(_sage_const_32 , r"""
sage: F13 = GF(13)
sage: L_EPJJ = []
....: for x in F13:
....:     for y in F13:
....:         if F13(3)*x^2 + y^2 == 1+ F13(8)*x^2*y^2:
....:             L_EPJJ.append((x,y))
sage: EPJJ = Set(L_EPJJ)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_815 )
try:
 _st_.current_tex_line = _sage_const_899 
 _st_.commandline(_sage_const_33 , r"""
sage: p = 13
sage: # large prime factor
sage: n = 5
sage: for k in range(1,5): # Fermat's little theorem
....:     if (p^k-1)%n == 0:
....:         break
sage: k
sage: # small prime factor
sage: n = 2
sage: for k in range(1,2): # Fermat's little theorem
....:     if (p^k-1)%n == 0:
....:         break
sage: k
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_913 )
try:
 _st_.current_tex_line = _sage_const_918 
 _st_.commandline(_sage_const_34 , r"""
sage: p = 115792089237316195423570985008687907853269984665640564039457584007908834671663
sage: n = 115792089237316195423570985008687907852837564279074904382605163141518161494337
sage: for k in range(1,1000):
....:     if (p^k-1)%n == 0:
....:         break
sage: k
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_925 )
try:
 _st_.current_tex_line = _sage_const_956 
 _st_.commandline(_sage_const_35 , r"""
sage: F5= GF(5)
sage: F5t.<t> = F5[]
sage: P = F5t(t^2+2)
sage: P.is_irreducible()
sage: F5_2.<t> = GF(5^2, name='t', modulus=P)
sage: E1F5_2 = EllipticCurve(F5_2,[1,1])
sage: E1F5_2.order()
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_964 )
try:
 _st_.current_tex_line = _sage_const_988 
 _st_.commandline(_sage_const_36 , r"""
sage: INF = E1F5_2(0) # Point at infinity
sage: L_E1_3 = []
sage: for p in E1F5_2:
....:     if 3*p == INF:
....:         L_E1_3.append(p)
sage: E1_3 = Set(L_E1_3) # Full 3-torsion set
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_995 )
try:
 _st_.current_tex_line = _sage_const_1007 
 _st_.commandline(_sage_const_37 , r"""
sage: # define the extension field
sage: F13= GF(13) # prime field
sage: F13t.<t> = F13[] # polynomials over t
sage: P = F13t(t^4+2) # irreducible polynomial of degree 4
sage: P.is_irreducible()
sage: F13_4.<t> = GF(13^4, name='t', modulus=P) # F_{13^4}
sage: TJJF13_4 = EllipticCurve(F13_4,[8,8]) # tiny jubjub extension
sage: # compute the full 5-torsion
sage: L_TJJF13_4_5 = []
sage: INF = TJJF13_4(0)
sage: for P in INF.division_points(5): # [5]P == INF
....:     L_TJJF13_4_5.append(P)
sage: len(L_TJJF13_4_5)
sage: TJJF13_4_5 = Set(L_TJJF13_4_5)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1022 )
try:
 _st_.current_tex_line = _sage_const_1024 
 _st_.commandline(_sage_const_38 , r"""
sage: # define the extension field
sage: P = F13t(t^3+2) # irreducible polynomial of degree 3
sage: P.is_irreducible()
sage: F13_3.<t> = GF(13^3, name='t', modulus=P) # F_{13^3}
sage: TJJF13_3 = EllipticCurve(F13_3,[8,8]) # tiny jubjub extension
sage: # compute the 5-torsion
sage: L_TJJF13_3_5 = []
sage: INF = TJJF13_3(0)
sage: for P in INF.division_points(5): # [5]P == INF
....:     L_TJJF13_3_5.append(P)
sage: len(L_TJJF13_3_5)
sage: TJJF13_3_5 = Set(L_TJJF13_3_5) # full $5$-torsion
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1037 )
try:
 _st_.current_tex_line = _sage_const_1082 
 _st_.commandline(_sage_const_39 , r"""
sage: L_G1 = []
sage: for P in E1_3:
....:     PiP = E1F5_2([a.frobenius() for a in P]) # pi(P)
....:     if P == PiP:
....:         L_G1.append(P)
sage: G1 = Set(L_G1)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1089 )
try:
 _st_.current_tex_line = _sage_const_1091 
 _st_.commandline(_sage_const_40 , r"""
sage: L_G2 = []
sage: for P in E1_3:
....:     PiP = E1F5_2([a.frobenius() for a in P]) # pi(P)
....:     pP = 5*P # [5]P
....:     if pP == PiP:
....:         L_G2.append(P)
sage: G2 = Set(L_G2)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1099 )
try:
 _st_.current_tex_line = _sage_const_1104 
 _st_.commandline(_sage_const_41 , r"""
sage: L_TJJ_G1 = []
sage: for P in TJJF13_4_5:
....:     PiP = TJJF13_4([a.frobenius() for a in P]) # pi(P)
....:     if P == PiP:
....:         L_TJJ_G1.append(P)
sage: TJJ_G1 = Set(L_TJJ_G1)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1111 )
try:
 _st_.current_tex_line = _sage_const_1113 
 _st_.commandline(_sage_const_42 , r"""
sage: L_TJJ_G1 = []
sage: for P in TJJF13_4_5:
....:     PiP = TJJF13_4([a.frobenius() for a in P]) # pi(P)
....:     pP = 13*P # [5]P
....:     if pP == PiP:
....:         L_TJJ_G1.append(P)
sage: TJJ_G1 = Set(L_TJJ_G1)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1121 )
try:
 _st_.current_tex_line = _sage_const_1170 
 _st_.commandline(_sage_const_43 , r"""
sage: p = RR(115792089237316195423570985008687907853269984665640564039457584007908834671663)
sage: r = RR(115792089237316195423570985008687907852837564279074904382605163141518161494337)
sage: t = p + RR(1) -r
sage: abs(t) <= 2*sqrt(p)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1175 )
try:
 _st_.current_tex_line = _sage_const_1416 
 _st_.commandline(_sage_const_44 , r"""
sage: F43 = GF(43)
sage: F43t.<t> = F43[]
sage: F43_6.<v> = GF(43^6, name='v', modulus=t^6+6) # t^6+6 irreducible
sage: BLS6 = EllipticCurve (F43_6,[0 ,6])
sage: INF = BLS6(0) # point at infinity
sage: for P in INF.division_points(13): # PI(P) == [q]P
....:     if P.order() == 13: # exclude point at infinity
....:         PiP = BLS6([a.frobenius() for a in P])
....:         qP = 43*P
....:         if PiP == qP:
....:             print(P.xy())
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1428 )
try:
 _st_.current_tex_line = _sage_const_1454 
 _st_.commandline(_sage_const_45 , r"""
sage: g1 = BLS6([13,15])
sage: g2 = BLS6([7*v^2, 16*v^3])
sage: g1.weil_pairing(g2,13)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1458 )
try:
 _st_.current_tex_line = _sage_const_1480 
 _st_.commandline(_sage_const_46 , r"""
sage: F13 = GF(13)
sage: for A in xrange(3, 13):
....:     if (A-2) % 4 != 0:
....:         continue
....:     try:
....:         E = EllipticCurve(F13, [0, A, 0, 1, 0]) # Montgomery form
....:         E
....:         E.order()
....:     except:
....:         continue
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1491 )
try:
 _st_.current_tex_line = _sage_const_1495 
 _st_.commandline(_sage_const_47 , r"""
sage: for d in F13:
....:     j= ZZ(0)
....:     for x in F13:
....:         for y in F13:
....:             if x^2+y^2 == 1+d*x^2*y^2:
....:                 j=j+1
....:     print('d=',d)
....:     print('order=',j)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1504 )
try:
 _st_.current_tex_line = _sage_const_1516 
 _st_.commandline(_sage_const_48 , r"""
sage: for x in F13:
....:     for y in F13:
....:         if x^2+y^2 == F13(1)+F13(7)*x^2*y^2:
....:             print(x,y)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1521 )
try:
 _st_.current_tex_line = _sage_const_1550 
 _st_.commandline(_sage_const_49 , r"""
sage: def Edwards_add((x1,y1),(x2,y2),d):
....:     x3 = F13((F13(x1)*F13(y2)+F13(y1)*F13(x2))/((F13(1)+F13(d)*F13(x1)*F13
....: (x2)*F13(y1)*F13(y2))))
....:     y3 = F13((F13(y1)*F13(y2)-F13(x1)*F13(x2))/((F13(1)-F13(d)*F13(x1)*F13
....: (x2)*F13(y1)*F13(y2))))
....:     return (x3,y3)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1557 )
try:
 _st_.current_tex_line = _sage_const_1650 
 _st_.commandline(_sage_const_50 , r"""
sage: F13 = GF(13)
sage: for A in xrange(3, 13):
....:     if (A-2) % 4 != 0:
....:         continue
....:     try:
....:         E = EllipticCurve(F13, [0, A, 0, 1, 0]) # Montgomery form
....:         E
....:         E.order()
....:     except:
....:         continue
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1661 )
try:
 _st_.current_tex_line = _sage_const_1665 
 _st_.commandline(_sage_const_51 , r"""
sage: j = ZZ(0)
sage: for a in F13:
....:     for d in F13:
....:         j = 0
....:         for x in F13:
....:             for y in F13:
....:                 if a*x^2 + y^2 == 1+d*x^2*y^2:
....:                     j=j+1
....:         print('curve: a=',a,'d=',d,'order:',j)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1675 )
try:
 _st_.current_tex_line = _sage_const_1691 
 _st_.commandline(_sage_const_52 , r"""
sage: for x in F13:
....:     for y in F13:
....:         if F13(2)*x^2+y^2 == F13(1)+F13(11)*x^2*y^2:
....:             print(x,y)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1696 )
try:
 _st_.current_tex_line = _sage_const_1719 
 _st_.commandline(_sage_const_53 , r"""
sage: def Edwards_add((x1,y1),(x2,y2),a,d):
....:     x3 = F13((F13(x1)*F13(y2)+F13(y1)*F13(x2))/((F13(1)+F13(d)*F13(x1)*F13(x2)*F13(y1)*F13(y2))))
....:     y3 = F13((F13(y1)*F13(y2)-F13(a)*F13(x1)*F13(x2))/((F13(1)-F13(d)*F13(x1)*F13(x2)*F13(y1)*F13(y2))))
....:     return (x3,y3)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1724 )
try:
 _st_.current_tex_line = _sage_const_1749 
 _st_.commandline(_sage_const_54 , r"""
sage: F7 = GF(7)
sage: MNT4 = EllipticCurve (F7,[4 ,1])
sage: [P.xy() for P in MNT4.points() if P.order() > 1]
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1753 )
try:
 _st_.current_tex_line = _sage_const_1780 
 _st_.commandline(_sage_const_55 , r"""
sage: F7t.<t> = F7[]
sage: F7_4.<u> = GF(7^4, name='u', modulus=t^4+t+1) # embedding degree is 4
sage: MNT4 = EllipticCurve (F7_4,[4 ,1])
sage: INF = MNT4(0) # point at infinity
sage: for P in INF.division_points(5): # PI(P) == [q]P
....:     if P.order() == 5: # exclude point at infinity
....:         PiP = MNT4([a.frobenius() for a in P])
....:         qP = 7*P
....:         if PiP == qP:
....:             print(P.xy())
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1791 )
try:
 _st_.current_tex_line = _sage_const_1808 
 _st_.commandline(_sage_const_56 , r"""
sage: g1 = MNT4([0,1])
sage: g2 = MNT4(2*u^3 + 5*u^2 + 4*u + 2, 2*u^3 + 3*u + 5)
sage: g1.weil_pairing(g2,5)
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1812 )
try:
 _st_.current_tex_line = _sage_const_1884 
 _st_.commandline(_sage_const_57 , r"""
sage: G.<x> = GF(5^6) # embedding degree is 6
sage: MNT6 = EllipticCurve (G,[2 ,1])
sage: INF = MNT6(0) # point at infinity
sage: for P in INF.division_points(7): # PI(P) == [q]P
....:     if P.order() == 7: # exclude point at infinity
....:         PiP = MNT6([a.frobenius() for a in P])
....:         qP = 5*P
....:         if PiP == qP:
....:             print(P.xy())
""", globals(), locals(), True)
except:
 _st_.goboom(_sage_const_1894 )
_st_.endofdoc()

